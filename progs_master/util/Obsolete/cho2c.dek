C=DECK CHO2C  CHO2C  FORTRAN
      subroutine    CHO2C
     $                     (h, o, c, n)
C+---------------------------------------------------------------------+
C|    CHO2C copies a Hollerith string into a Fortran 77 CHARACTER      |
C|    string.  It is a variant of CH2C; CHO2C accepts an offset        |
C|    argument that applies to the first Hollerith word.               |
C+---------------------------------------------------------------------+
C|    The calling sequence is:                                         |
C|                                                                     |
C|        CALL     CHO2C  (H, O, C, N)                                 |
C|                                                                     |
C|    Inputs -                                                         |
C|                                                                     |
C|      H          Source Hollerith string.                            |
C|      O          Offset of first byte in H to be copied              |
C|                 to C.  Only O>0 or O=0 is safe.                     |
C|      C          Target character string.                            |
C|      N          Number of characters to be moved.                   |
C|                 No operation if N le 0.                             |
C|                                                                     |
C|    Outputs -                                                        |
C|                                                                     |
C|      C          Updated character string.                           |
C+---------------------------------------------------------------------+
      implicit      none
#if defined(unix) || defined(linux)

#ifdef alpha
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, mask, n, o, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko-1)/4 + 1
        ras   =  24 - 8 * (4*iwd - ko)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef ardent
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, mask, n, o, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / '000000FF'X /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko-1)/4 + 1
        ras   =  -8 * (4*iwd - ko)
        ich   =  IAND (ISHFT (h(iwd),ras), mask)
        c(k)  =  CHAR (ich)
 1000 continue
#else
#ifdef convex
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      integer       ich, k, ko, n, o
      logical*1     h(*)
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        ich   =  h(ko)
        c(k)  =  CHAR (ich)
 1000 continue
#else
#ifdef cray
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, lcs, n, o
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko - 1)/8 + 1
        lcs   =  8 * (ko - 8*(iwd-1))
        ich   =  AND( SHIFT(h(iwd),lcs), MASK(120))
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef dec3100
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, mask, n, o, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko-1)/4 + 1
        ras   =  24 - 8 * (4*iwd - ko)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef hp
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      logical*1     h(*)
      integer       n, o
C
      integer       ich,      k
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ich   =  h(k+o)
        c(k)  =  CHAR (ABS(ich))
 1000 continue
#else
#ifdef ibm
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      integer       k, ko, n, o
      character     h(*)
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        c(k)  =  h(ko)
 1000 continue
#else
#ifdef i386
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, mask, n, o, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko-1)/4 + 1
        ras   =  24 - 8 * (4*iwd - ko)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef sparc
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, mask, n, o, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko-1)/4 + 1
        ras   =  8 * (4*iwd - ko)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef vax
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, mask, n, o, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko - 1)/4 + 1
        ras   =  24 - 8 * (4*iwd - ko)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, mask, n, o, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko - 1)/4 + 1
        ras   =  8 * (4*iwd - ko)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#endif
#endif
#endif
#endif
#endif
#endif
#endif
#endif
#endif
#endif

#else

#ifdef cdc
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(1)
      integer       h(1), ko, n, o
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        lh   =   (ko - 1)/10
        c(k) =   CHAR (SHIFT(h(lh+1),6*(ko-10*lh)) .and. 63)
 1000 continue
#else
#ifdef cray
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, lcs, n, o
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko - 1)/8 + 1
        lcs   =  8 * (ko - 8*(iwd-1))
        ich   =  AND( SHIFT(h(iwd),lcs), MASK(120))
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef dps8
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, lcs, mask, n, o
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / 12O000000000377 /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko - 1)/4 + 1
        lcs   =  9 * (k - 4*iwd)
        ich   =  IAND (ISC(h(iwd),lcs), mask)
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef fps
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, k, ko, n, iwd, o, pos
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko - 1)/8 + 1
        pos   =  8*((ko-1) - 8*(iwd-1))
        ich   =  EXTRACT (h(iwd), pos, 8)
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef ibm
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      logical*1     h(*)
      integer       ich, k, ko, n, o
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        ich   =  h(ko)
        c(k)  =  CHAR (ABS(ich))
 1000 continue
#else
#ifdef sperry
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, ko, lcs, n, o
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        iwd   =  (ko - 1)/4 + 1
        lcs   =  9 * (ko - 4*iwd)
        ich   =  BITS (h(iwd), lcs-8, 9)
        c(k)  =  CHAR(ich)
 1000 continue
*
*     call      CMOVE  (h, 1+o, c, 1, n)
*
#else
#ifdef vax
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      logical*1     h(*)
      integer       ich, k, ko, n, o
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ko    =  k + o
        ich   =  h(ko)
        c(k)  =  CHAR (ABS(ich))
 1000 continue
#else
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*(*) c
      logical*1     h(*)
      integer       n, o
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      m1 =    0
      do 1000  k = 1,(n+127)/128
        m2    =  MIN(m1+n-128*(k-1),m1+128)
        write (c(m1+1:m2),'(128A1)'),  (h(i+o),i=m1+1,m2)
        m1    =  m2
 1000 continue
#endif
#endif
#endif
#endif
#endif
#endif
#endif

#endif

      return
      end
