C=DECK CH2C   CH2C   FORTRAN
      subroutine    CH2C
     $                    (h, c, n)
C+---------------------------------------------------------------------+
C|    CH2C copies a Hollerith string into a Fortran 77 CHARACTER       |
C|    string.  This "conversion" is needed to fool the compiler and    |
C|    the block i/o system, in order to input/output char data.        |
C+---------------------------------------------------------------------+
C|    The calling sequence is:                                         |
C|                                                                     |
C|        CALL     CH2C  (H, C, N)                                     |
C|                                                                     |
C|    Inputs -                                                         |
C|                                                                     |
C|      H          Source Hollerith string.                            |
C|      C          Target character string.                            |
C|      N          Number of characters to be moved.                   |
C|                 No operation if N le 0.                             |
C|                                                                     |
C|    Outputs -                                                        |
C|                                                                     |
C|      C          Updated character string.                           |
C+---------------------------------------------------------------------+
      implicit      none
#if defined(unix) || defined(linux)

#ifdef alpha
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, mask, n, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k-1)/4 + 1
        ras   =  24 - 8 * (4*iwd - k)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef ardent
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, mask, n, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / '000000FF'X /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        ras   =  -8 * (4*iwd - k)
        ich   =  IAND (ISHFT (h(iwd),ras), mask)
        c(k)  =  CHAR (ich)
 1000 continue
#else
#ifdef convex
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      integer       ich, k, n
      integer*1     h(*)
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ich   =  h(k)
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef cray
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, k, n, iwd, lcs
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/8 + 1
        lcs   =  8*( k - 8*(iwd-1))
        ich   =  AND( SHIFT(h(iwd),lcs), MASK(120))
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef dec3100
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, mask, n, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        ras   =  24 - 8 * (4*iwd - k)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef hp
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      logical*1     h(*)
      integer       n
C
      integer       ich,      k
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ich   =  h(k)
        c(k)  =  CHAR (ABS(ich))
 1000 continue
#else
#ifdef ibm
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      integer       k, n
      character     h(*)
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        c(k)  =  h(k)
 1000 continue
#else
#ifdef i386
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, mask, n, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        ras   =  24 - 8 * (4*iwd - k)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef sparc
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, mask, n, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        ras   =  8 * (4*iwd - k)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
#ifdef vax
      character*1   c(*)
      integer       h(*), ich, iwd, k, mask, n, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        ras   =  24 - 8 * (4*iwd - k)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#else
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, mask, n, ras
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / z'000000FF' /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        ras   =  8 * (4*iwd - k)
        ich   =  and (rshift (h(iwd),ras), mask)
        c(k)  =  char (ich)
 1000 continue
#endif
#endif
#endif
#endif
#endif
#endif
#endif
#endif
#endif
#endif

#else

#ifdef cdc
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(1)
      integer       h(1), k, lh, n
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        lh    =  (k - 1)/10
        c(k)  =  CHAR (SHIFT(h(lh+1),6*(k-10*lh)) .and. 63)
 1000 continue
#else
#ifdef cray
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, k, n, iwd, lcs
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/8 + 1
        lcs   =  8*( k - 8*(iwd-1))
        ich   =  AND( SHIFT(h(iwd),lcs), MASK(120))
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef dps8
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, lcs, mask, n
C+---------------------------------------------------------------------+
C|                  D A T A                                            |
C+---------------------------------------------------------------------+
      data          mask / 12O000000000377 /
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        lcs   =  9 * (k - 4*iwd)
        ich   =  IAND (ISC(h(iwd),lcs), mask)
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef fps
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, k, n, iwd, pos
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/8 + 1
        pos   =  8 * ((k-1) - 8*(iwd-1))
        ich   =  EXTRACT (h(iwd), pos, 8)
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef ibm
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      integer       ich, k, n
      logical*1     h(*)
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ich   =  h(k)
        c(k)  =  CHAR(ABS(ich))
 1000 continue
#else
#ifdef sperry
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*1   c(*)
      integer       h(*), ich, iwd, k, lcs, n
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        iwd   =  (k - 1)/4 + 1
        lcs   =  9 * (k - 4*(iwd-1))
        ich   =  BITS (h(iwd), lcs-8, 9)
        c(k)  =  CHAR(ich)
 1000 continue
#else
#ifdef vax
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character     c(*)
      integer       ich, k, n
      logical*1     h(*)
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      do 1000  k = 1,n
        ich   =  h(k)
        c(k)  =  CHAR(ABS(ich))
 1000 continue
#else
#ifdef generic
C+---------------------------------------------------------------------+
C|                  T Y P E   &   D I M E N S I O N                    |
C+---------------------------------------------------------------------+
      character*(*) c
      integer       k, m1, m2, n
      logical*1     h(*)
C+---------------------------------------------------------------------+
C|                  L O G I C                                          |
C+---------------------------------------------------------------------+
      m1 =    0
      do 1000  k = 1,(n+127)/128
        m2    =  MIN(m1+n-128*(k-1),m1+128)
        write (c(m1+1:m2),'(128A1)'),  (h(i),i=m1+1,m2)
        m1    =  m2
 1000 continue
#endif
#endif
#endif
#endif
#endif
#endif
#endif

#endif

      return
      end
