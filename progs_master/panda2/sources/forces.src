C=DECK      FORCEX
      SUBROUTINE FORCEX(IFILE,IFX,IPRINT,NSEG,CX,CY,CS,NX,NY,NXY,RESULT,
     1        RESFIX,RESEIG,ISTIF,WRESID,WBEND,
     1        ZPARTX,ZPARTY,EIGGEN,EPSLOD,ETHERM,THERMX,THERMY,
     1        LENMOD,CSINV,ETHRMX,ETHRMY,ICOCUR,NPRT,
     1        EPSTOT,EPSFIX,EPSEIG,FSTRN,GSTRN,STIF1L,STIF2L,
     1        NX0,NY0,NXY0,EPSFXL,RESFXL,RESTOT,FNXP0,FNYP0,
     1        WPRESG,EAVEP,RESPGL,EPSPGL,RESPRS,EPSPRS,P,FNXPL0,FNYPL0,
     1        EAVEPL,WPRES,EPSLDF,WIMPG,WIMPL,IMOD,IABP,FSLOC,IWIDE,
     1        JJJ,AMPLIT,ECC,RWBTOT,RWBEIG,MIDEND,IBOUND,IBPRE,PRELEN,
     1        ITYPE,THSMRX,THSMRY,ETSMRX,ETSMRY,ICASE,MX,MY,IABT,AMPLT2,
C BEG OCT 1998
     1        NNODES,TEMP,IMTEMP,IQUICK,ETHRMS,RESBGL,EPSBGL,EAVEPB)
C END OCT 1998
C
C  PURPOSE IS TO OBTAIN RESULTANTS IN ALL SEGMENTS DUE TO IMPOSED
C  RESULTANTS ON THE PANEL: NX, NY, NXY. WARPING OF THE PANEL DUE TO
C  COCURING SKIN AND STIFFENERS IS ACCOUNTED FOR. THE GROWTH IN THE
C  BOWING OF THE PANEL AS THE LOAD IS APPLIED IS ALSO ACCOUNTED FOR.
C  THERMAL STRESSES AND DEFORMATIONS CORRESPONDING TO APPLIED TEMPERATURES
C  ARE ALSO ACCOUNTED FOR.  APPLIED MOMENTS, MX, MY (LOAD SET A) 
C  WERE ADDED 1 MAY 1989.
C
C BEG OCT 1998
      DIMENSION RESBGL(3,5,2),EPSBGL(3,5,2),RWBBGL(2),WBBGL(2,4,2)
      DIMENSION RSBGL(3,5,3),ESBGL(3,5,3),RWBGL(3),EAVEPB(*)
      DIMENSION EPPB(6),EPSPB(6),EPSBPB(6)
      COMMON/FCERNG/FCEWEB,FCEFLG,FCEWBA,FCEFGA,FCEWBB,FCEFGB,
     1              FCEWBT,FCEFGT
      COMMON/EPSRNG/EPSRGA,EPSRGB,EPSRGT
C END OCT 1998
C BEG JUN 1996
      DIMENSION ETHRMS(*)
      COMMON/ITHRMX/IETHRM
      COMMON/GEOM6/IFAY(2),ITRTOT,IRESET,NLOADS,NSTEPS,WMAXXX,NCROSS,
     1       NOPLOT,KMAX,ILAYPL,XMAXX,XMIN,YMAXX,YMIN,N3DPLT,NOBJ,
     1       NSTRNS,NPLTST,NABSCI,IDIAG,ITRALL,IFAYT(2),IBEAM,IMISCL(5)
C END JUN 1996
C BEG OCT 1996
      COMMON/EIGPRL/EIGAMG,EIGAMS,CSLAMG,CSLAMS,FACAMG,FACAMS
C END OCT 1996
      COMMON/ESHORT/EXAVE,EXAVEA,TXALOW
      COMMON/SHRWEB/SHEARX,XMAX,SHEARY,YMAX
      COMMON/NEUTRL/DNEUTX,DNEUTY,DSURF
      COMMON/GEOM1/AXIAL,CIRC,R
      COMMON/GEOM2/B(2),B2(2),H(2),W(2),W2(2)
      COMMON/STPART/EX2L,EY3L,EX3L,EY2L,EX2T,EY3T,EX3T,EY2T
      COMMON/CUPART/KX2L,KY3L,KX3L,KY2L,KX2T,KY3T,KX3T,KY2T
      COMMON/SHEARE/EP121L,EP122L,EP123L,EP121T,EP122T,EP123T
C BEG SEPT 1990
      COMMON/INDMOM/FMOM,FNCIRC
C END SEPT 1990
C BEG 26 JAN 1989
      COMMON/THICK/TX(5),TY(5)
C END 26 JAN 1989
C BEG MAR 1991
      COMMON/EDGCON/PEDG
      LOGICAL PEDG
C END MAR 1991
C BEG APR 1992
      COMMON/RNGWXX/WXXFLN,POPRNG
      COMMON/BNDLAY/BLL
C END APR 1992
C BEG AUG 1992
      CHARACTER*8 WRDISO
      DIMENSION TEMP(4,2),C33REG(3,3)
      COMMON/ISOGR/ISOGRD,ISOANG
      COMMON/WLOCAX/POPISO
      COMMON/LOADS6/RSEIG(3,5,3),RSFXL(3,5,3),RSPGL(3,5,3),RSFIX(3,5,3)
      COMMON/LOADS7/ESEIG(3,5,3),ESFXL(3,5,3),ESPGL(3,5,3),ESFIX(3,5,3)
      COMMON/LOADS8/RWEIG(3),RWFXL(3),RWPGL(3),RWFIX(3),RWTOT(3)
      COMMON/LOADS9/RSPRS(3,5,3),ESPRS(3,5,3),RSTOT(3,5,3),RSULT(3,5,3)
      COMMON/LODS10/ESTOT(3,5,3)
      COMMON/LODS11/WBEIG(2,4,2),WBTOT(2,4,2),WBSULT(2,4,2)
      COMMON/LODS12/WBFXL(2,4,2),WBPGL(2,4,2),WBFIX(2,4,2),WBPRS(2,4,2)
      COMMON/WEBTH1/CX3(6,6,11),CY3(6,6,11),THRMX3(6,11),THRMY3(6,11)
      COMMON/WEBTH2/TSMRX3(6,11),TSMRY3(6,11),ESMRX3(6,11),ESMRY3(6,11)
C END AUG 1992
C BEG NOV 1992
      COMMON/ISKPL/ISKIPL,IRMOD,IBLL,ICD7,ICD8,ICD9
      COMMON/ICODIX/ICODIF(2)
      DIMENSION THDUM(6)
      LOGICAL ICODIF
C END NOV 1992
C BEG APRIL 1990
      DIMENSION CSTEMP(6,6)
C END APRIL 1990
      DIMENSION NSEG(*),CX(6,6,5),CY(6,6,5),CS(6,6),RESTOT(3,5,2)
      DIMENSION RESFIX(3,5,2),RESEIG(3,5,2),FSTRN(5,2,5),GSTRN(5,2,5)
      DIMENSION RESFXL(3,5,2),RESULT(3,5,2),RESPRS(3,5,2),EPSPRS(3,5,2)
      DIMENSION EPSTOT(3,5,2),EPSFIX(3,5,2),EPSEIG(3,5,2),EPSFXL(3,5,2)
      DIMENSION ISTIF(*),ZPARTX(*),ZPARTY(*),APPLOD(6),EPSLOD(*)
      DIMENSION EPSLDF(*),RWBFIX(2),RWBPGL(2),RWBFXL(2),RWBEIG(2)
      DIMENSION RWBTOT(2),WBOUND(2)
      DIMENSION FIXLOD(6),EPSLD0(6),EAVEP(6),RESPGL(3,5,2),EPSPGL(3,5,2)
      DIMENSION CSINV(6,6),ETHERM(*),THERMX(6,5),THERMY(6,5),ETH(6)
      DIMENSION ETHRMX(6,5),ETHRMY(6,5),ICOCUR(2),CSBEND(2,2),EAVEPL(*)
      DIMENSION ET(6),EP(6),EP0(6),EPS(6),EPS0(6),EPP(6),EPSP(6)
      DIMENSION EPSB(6),EPSB0(6),ETHB(6),ICO(2),EPSBP(6)
      DIMENSION WRESID(*),CS23S(2,2),CS32S(2,2),TS23S(2),TS32S(2)
C BEG 26 JAN 1989
      COMMON/WEBTH4/ET3X,TT3X,ET3Y,TT3Y
      DIMENSION EPSDUM(6,5),THSMRX(6,5),THSMRY(6,5)
      DIMENSION ETSMRX(6,5),ETSMRY(6,5)
C END 26 JAN 1989
C
      REAL NX,NY,NXY,LENMOD,KX3L,KY2L,KX2L,KY3L,KX3T,KY2T,KX2T,KY3T
      REAL NX0,NY0,NXY0,KX3L0,KY2L0,KX2L0,KY3L0,KX3P,KY2P,KX2P,KY3P
C BEG OCT 1998
      REAL KX3B,KY2B,KX2B,KY3B
C END OCT 1998
C BEG 1 MAY 1989
      REAL MX,MY
C END 1 MAY 1989
      CHARACTER*14 WBOUND
      LOGICAL IPSWIT
C BEG JULY 1993
      COMMON/RADIM2/WYYAMP,W0PAN,WYYGEN,WYYPAN,WYYLOC
      COMMON/AMPL3/AMPLT3,AMPLT4
      LOGICAL LGSTF1,LGSTF2,LGSTF3
      LGSTF1 = ISTIF(1).NE.0.AND.ISTIF(2).EQ.0
      LGSTF2 = ISTIF(2).NE.0.AND.ISTIF(1).EQ.0
      LGSTF3=PEDG.AND.ISTIF(1).NE.0.AND.ISTIF(2).NE.0
C END JULY 1993
C
C*******************************************************************
C BEGIN MISCELLANEOUS CALCULATIONS AND INITIALIZATIONS.
C*******************************************************************
C
      PI = 3.1415927
      IPFCE = 0
C BEG JULY 1995
C     FACTMX = 1.0
      FACTMX = 0.0
C     IF (IQUICK.EQ.1.AND.PEDG) FACTMX = 0.
C     IF (                PEDG) FACTMX = 0.
C END JULY 1995
C BEG SEPT 1991
      IPSWIT = IPRINT.GE.1.OR.NPRT.GE.1
C END SEPT 1991
      IF (IFX.GT.0.AND.IPSWIT) IPFCE = 1
C BEG 26 JAN 1989
      CALL MOVER(0.,0,EPSDUM,1,30)
C END 26 JAN 1989
      CALL MOVER(0.,0,RESULT,1,30)
      CALL MOVER(0.,0,RESTOT,1,30)
      CALL MOVER(0.,0,RESEIG,1,30)
      CALL MOVER(0.,0,RESFXL,1,30)
      CALL MOVER(0.,0,RESFIX,1,30)
      CALL MOVER(0.,0,RESPGL,1,30)
      CALL MOVER(0.,0,EPSPGL,1,30)
      CALL MOVER(0.,0,EPSTOT,1,30)
      CALL MOVER(0.,0,EPSEIG,1,30)
      CALL MOVER(0.,0,EPSFXL,1,30)
      CALL MOVER(0.,0,EPSFIX,1,30)
      RWBEIG(1) = 0.
      RWBEIG(2) = 0.
      RWBTOT(1) = 0.
      RWBTOT(2) = 0.
      RWBPGL(1) = 0.
      RWBPGL(2) = 0.
      RWBFXL(1) = 0.
      RWBFXL(2) = 0.
      RWBFIX(1) = 0.
      RWBFIX(2) = 0.
C BEG AUG 1992
      CALL MOVER(0.,0,WBTOT,1,16)
      CALL MOVER(0.,0,WBEIG,1,16)
      CALL MOVER(0.,0,WBFXL,1,16)
      CALL MOVER(0.,0,WBFIX,1,16)
      CALL MOVER(0.,0,WBPGL,1,16)
      CALL MOVER(0.,0,WBPRS,1,16)
      CALL MOVER(0.,0,WBSULT,1,16)
      IF (ISOGRD.EQ.1) THEN
         SHEARX = 0.
         CALL MOVER(0.,0,RSULT,1,45)
         CALL MOVER(0.,0,RSTOT,1,45)
         CALL MOVER(0.,0,RSEIG,1,45)
         CALL MOVER(0.,0,RSFXL,1,45)
         CALL MOVER(0.,0,RSFIX,1,45)
         CALL MOVER(0.,0,RSPGL,1,45)
         CALL MOVER(0.,0,RSPRS,1,45)
         CALL MOVER(0.,0,ESPGL,1,45)
         CALL MOVER(0.,0,ESPRS,1,45)
         CALL MOVER(0.,0,ESTOT,1,45)
         CALL MOVER(0.,0,ESEIG,1,45)
         CALL MOVER(0.,0,ESFXL,1,45)
         CALL MOVER(0.,0,ESFIX,1,45)
         DO 2 I = 1,3
            RWEIG(I) = 0.
            RWTOT(I) = 0.
            RWPGL(I) = 0.
            RWFXL(I) = 0.
            RWFIX(I) = 0.
    2    CONTINUE
      ENDIF
C END AUG 1992
C BEG OCT 1998
      IF (PEDG) THEN
         CALL MOVER(0.,0,RESBGL,1,30)
         CALL MOVER(0.,0,EPSBGL,1,30)
         RWBBGL(1) = 0.
         RWBBGL(2) = 0.
         CALL MOVER(0.,0,WBBGL,1,16)
         IF (ISOGRD.EQ.1) THEN
            CALL MOVER(0.,0,RSBGL,1,45)
            CALL MOVER(0.,0,ESBGL,1,45)
            RWBGL(1) = 0.
            RWBGL(2) = 0.
            RWBGL(3) = 0.
         ENDIF
      ENDIF
C END OCT 1998
C BEG NOV 1991
      FACTMP = 1.0
C END NOV 1991
C
C  SET THE LOAD ECCENTRICITIES, ECC AND ECCY, IF THE PANEL IS LOADED THRU
C  THE SKIN RATHER THAN THRU THE NEUTRAL PLANE...
C
      IF (IBPRE.EQ.0.AND.ABS(ECC).GT.0.0) THEN
         ECC = -DNEUTX
C BEG JUN 1999
         ECCY= -DNEUTY
      ELSE
         ECC = 0.0
         ECCY = 0.0
      ENDIF
      IF (IBPRE.EQ.0.AND.ISTIF(1).EQ.0.AND.ISTIF(2).NE.0) ECCY=-DNEUTY
C BEG APR 2007 (always do hoop load at the neutral plane for hoop bending)
      ECCY = 0.0
C END APR 2007
      IF (EIGGEN.EQ.0.) THEN
         ECC = 0.
         ECCY= 0.
      ENDIF
C END JUN 1999
C
C  GET NORMAL DEFLECTION WRESID AT MIDLENGTH OF THE PANEL...
C
   10 CONTINUE
C
C BEG JAN 1995
      IF (PEDG) THEN
         WTAXIA = WRESID(1)
      ELSE
C BEG MAR 1995
C BEG JUN 1996
C23456789012345678901234567890123456789012345678901234567890123456789012
         WRESID(1) = - ETHRMS(4)*B(2)**2/PI**2
         WRESID(2) = - ETHRMS(5)*CIRC**2/PI**2
         WTAXIA    = - ETHRMS(4)*AXIAL**2/PI**2
         IF (IMOD.EQ.0) IETHRM = 0
         IF ((AXIAL.GT.1.1*CIRC.AND.ABS(WTAXIA).GT.ABS(WRESID(2))).OR.
     1       (CIRC.GT.1.1*AXIAL.AND.ABS(WRESID(2)).GT.ABS(WTAXIA)).OR.
     1       IETHRM.EQ.1) THEN
            IF (IMOD.EQ.0.AND.IBEAM.EQ.0) IETHRM = 1
            IF (IETHRM.EQ.1) THEN
               WRESMN = MIN(ABS(WRESID(2)),ABS(WTAXIA))
               BWSIGN = 1.0
               IF (WRESID(2).NE.0.0) BWSIGN = WRESID(2)/ABS(WRESID(2))
               WRESID(2) = MIN(ABS(WRESID(2)),WRESMN)*BWSIGN
               BWSIGN = 1.0
               IF (WTAXIA.NE.0.0) BWSIGN = WTAXIA/ABS(WTAXIA)
               WTAXIA = MIN(ABS(WTAXIA),WRESMN)*BWSIGN
               BWSIGN = 1.0
               IF (WRESID(1).NE.0.0) BWSIGN = WRESID(1)/ABS(WRESID(1))
               WRESID(1) = MIN(ABS(WRESID(1)),WRESMN)*BWSIGN
               ETHERM(4) = -WTAXIA*PI**2/AXIAL**2
               ETHERM(5) = -WRESID(2)*PI**2/CIRC**2
               DELKP1 = ETHERM(4) - ETHRMS(4)
               DELKP2 = ETHERM(5) - ETHRMS(5)
               DELCS  = CS(1,1)*CS(2,2) - CS(1,2)**2
               DELB1  = CS(1,4)*DELKP1 + CS(1,5)*DELKP2
               DELB2  = CS(2,4)*DELKP1 + CS(2,5)*DELKP2
               DELEP1 = (-CS(2,2)*DELB1 + CS(1,2)*DELB2)/DELCS
               DELEP2 = ( CS(1,2)*DELB1 - CS(1,1)*DELB2)/DELCS
               ETHERM(1) = ETHRMS(1) + DELEP1
               ETHERM(2) = ETHRMS(2) + DELEP2
C BEG JUN 1999
               IF (CIRC.LT.B(2).AND.(.NOT.LGSTF1))
     1                            WRESID(1) = WRESID(1)*(CIRC/B(2))**2
               IF (AXIAL.LT.CIRC.AND.(.NOT.LGSTF2))
     1                            WRESID(2) = WRESID(2)*(AXIAL/CIRC)**2
C23456789012345678901234567890123456789012345678901234567890123456789012
C END JUN 1999
            ENDIF
         ENDIF
C END JUNE 1996
C END MAR 1995
      ENDIF
C END JAN 1995
      IF ((CIRC/R).GT.0.5) WRESID(2) = 0.
      BOWMX = 0.
      BOWMY = 0.
C BEG NOV 1992
      IF ((MX.NE.0.0.OR.MY.NE.0.0).AND.FMOM.EQ.0.0.AND.IBLL.EQ.0)
C BEG JULY 1995
     1      CALL BOWMOM(0,CS,MX,MY,IBPRE,AXIAL,CIRC,BOWMX,BOWMY,CURVY,
     1                  FEPS1,FEPS2)
C END JULY 1995
C END NOV 1992
C BEG JULY 1995 (ADD CODING FOR CIRCUMFERENTIAL BENDING OF CURVED PANEL
C                UNDER CONSTANT MOMENT MY ALONG THE TWO GENERATORS)
      CURVY = 0.
      FEPS1 = 0.
      FEPS2 = 0.
      IF (MY.NE.0.0.AND.PEDG)
     1      CALL BOWMOM(1,CS,MX,MY,IBPRE,AXIAL,CIRC,DUMMX,DUMMY,CURVY,
     1                  FEPS1,FEPS2)
      IF (ICASE.EQ.2.AND.ISTIF(2).EQ.0) THEN
         CURVY = 0.
         FEPS1 = 0.
         FEPS2 = 0.
      ENDIF
C END JULY 1995
C BEG JUN 1999
      FMULTX = 1.0
      FMULTY = 1.0
      IF (IBLL.EQ.0) THEN
         IF (CIRC.LT.AXIAL.AND.(.NOT.LGSTF1)) FMULTX =(CIRC/AXIAL)**2
         IF (AXIAL.LT.CIRC.AND.(.NOT.LGSTF2)) FMULTY =(AXIAL/CIRC)**2
      ENDIF
C END JUN 1999
      IF (IPFCE.GE.1) THEN
C BEG AUG 1992
         WRDISO = 'STRINGER'
         IF (ISOGRD.EQ.1) WRDISO = 'ISOGRID '
         WRITE(IFILE,3) WRDISO,(ZPARTX(I),I=1,4),(ZPARTY(I),I=1,4)
    3  FORMAT(//' POSITIONS OF STIFFENER SEGMENT CENTROIDS BELOW THE REF
     1ERENCE SURFACE OF THE PANEL SKIN...'//
     1       '   ',  A, ' PARTS...ZPARTX(I), I=1,4=      ',1P,4E12.4/
     1       '   RING     PARTS...ZPARTY(I), I=1,4=      ',1P,4E12.4/)
C
C BEG JUN 1999
         WRITE(IFILE,4) WIMPG,WRESID(1),WTAXIA,WRESID(2),WPRESG, WPRES,
     1                  MX,MY,BOWMX,BOWMY,WIMPL,IBLL,FMULTX,FMULTY
C END JUN 1999
C
C23456789012345678901234567890123456789012345678901234567890123456789012
    4    FORMAT(//' BOWING AMPLITUDES DUE TO INITIAL IMPERFECTION,'/
     1   ' CURING, OTHER TEMPERATURE LOADING, MOMENTS, AND PRESSURE...'/
     1      '   AXIAL BOWING DUE TO INITIAL IMPERFECTION  = ',1P,E12.4/
     1      '   AXIAL BOWING BETWEEN RINGS,THERMAL EFFECTS= ',1P,E12.4/
     1      '   OVERALL AXIAL      BOWING, THERMAL EFFECTS= ',1P,E12.4/
     1      '   OVERALL CIRCUMFER. BOWING, THERMAL EFFECTS= ',1P,E12.4/
     1      '   BOWING, ENTIRE PANEL UNDER PRESSURE       = ',1P,E12.4/
     1      '   BOWING, PANEL MODULE UNDER PRESSURE       = ',1P,E12.4/
     1      '   APPLIED AXIAL,HOOP MOMENTS,    MX, MY     = ',1P,2E12.4/
     1      '   AXIAL,HOOP BOWING CAUSED BY MOMENTS MX, MY= ',1P,2E12.4/
     1   ' INITIAL LOCAL IMPERFECTION IN SKIN...'/
C BEG JUN 1999
     1      '   LOCAL IMPERFECTION, WIMP(local)           = ',1P,E12.4/
     1   ' STRATEGY PARAMETERS, IBLL, FMULTX, FMULTY...'/
     1      '   "BOUNDARY LAYER" INDEX, IBLL              = ',I4/
     1      '   MULTIPLIER FOR AXIAL BOWING AMPLITUDES    = ',1P,E12.4/
     1      '   MULTIPLIER FOR CIRC. BOWING AMPLITUDES    = ',1P,E12.4/)
C23456789012345678901234567890123456789012345678901234567890123456789012
C END JUN 1999
C END AUG 1992
C
      ENDIF
C
C
C  NEXT, FILL THE APPLIED LOAD VECTOR, APPLOD.  NOTE THAT IT IS
C  ASSUMED THAT THERE ARE BENDING MOMENTS AT THE PANEL MIDLENGTH EQUAL
C  TO Mx = + Nx*WRESID(1)*AMPLIT,  My = + Ny*WRESID(2)*AMPLIT,
C  (IN WHICH AMPLIT IS GIVEN BY  AMPLIT = EIGGEN/(EIGGEN-1), THAT IS,
C  AMPLIT IS AN AMPLITUDE FACTOR THAT REFLECTS THE GROWTH OF THE BOW
C  WITH APPLIED LOAD), PLUS  NX*DNEUTX AND NY*DNEUTY, RESPECTIVELY,
C  IN WHICH DNEUTX, DNEUTY ARE THE DISTANCES FROM THE REFERENCE SURFACE
C  OF THE SKIN TO THE NEUTRAL PLANES FOR AXIAL BENDING (X) AND CIRC.
C  BENDING (Y) RESPECTIVELY.
C
C
C
   20 CONTINUE
C
C  WE WANT NOW TO SOLVE FOR REFERENCE SURFACE AVERAGE STRAIN AND
C  CHANGES IN CURVATURE AND TWIST, GIVEN THE APPLIED IN-PLANE LOADS
C  AND MOMENTS DUE TO WARPING AND THE FACT THAT THE IN-PLANE LOADS
C  ACT ALONG THE NEUTRAL PLANES OF THE STIFFENED PANEL...
C
      APPLOD(1) = NX
      APPLOD(2) = NY
      APPLOD(3) = NXY
      FIXLOD(1) = NX0
      FIXLOD(2) = NY0
      FIXLOD(3) = NXY0
C
   30 CONTINUE
C
C  AMPLITUDE FACTOR REFLECTS HYPERBOLIC GROWTH OF AXIAL BOWING, WHICH
C  MUST BECOME INFINITE WHEN EIGGEN = 1.0..
C
C BEG APRIL 1990
      AMPLIT = EIGGEN/(EIGGEN - 1.)
C END APRIL 1990
C BEG OCT 1996
      AMPAMG = FACAMG*EIGAMG/(EIGAMG - 1.)
      AMPAMS = FACAMS*EIGAMS/(EIGAMS - 1.)
C END OCT 1996
C BEG 26 JAN 1989
C BEG JULY 1989
C BEG JULY 1993
C     AMPMAX = 20.
      AMPMAX = 100.
C     IF (ITYPE.EQ.3) AMPMAX = 100.
C END JULY 1993
      IF (AMPLIT.LE.0.) AMPLIT = AMPMAX
      IF (AMPLIT.GT.AMPMAX) AMPLIT = AMPMAX
C BEG OCT 1996
      IF (AMPAMG.LE.0.) AMPAMG = AMPMAX
      IF (AMPAMG.GT.AMPMAX) AMPAMG = AMPMAX
      IF (AMPAMS.LE.0.) AMPAMS = AMPMAX
      IF (AMPAMS.GT.AMPMAX) AMPAMS = AMPMAX
C END OCT 1996
C END JULY 1989
C END 26 JAN 1989
      IF (EIGGEN.EQ.0.0) AMPLIT = 0.
C BEG OCT 1996
      IF (EIGAMG.EQ.0.0) AMPAMG = 0.
      IF (EIGAMS.EQ.0.0) AMPAMS = 0.
C END OCT 1996
C BEG APRIL 1990
C  AMPLITUDE FACTOR FOR BOWING DUE TO NORMAL PRESSURE IS
C  CALCULATED WITH USE OF THE BOUNDARY CONDITIONS FROM PREBUCKLING,
C  WHICH GOVERN THE GLOBAL BENDING AMPLITUDE DUE TO PRESSURE: WPRESG.
C
C BEG OCT 1996
C     EIGGNP = EIGGEN*(LENMOD/PRELEN)**2
      EIGGNP = EIGAMG*(LENMOD/PRELEN)**2
      AMPLT2 = FACAMG*EIGGNP/(EIGGNP - 1.)
C END OCT 1996
C BEG JULY 1993
C     AMPMAX = 20.
      AMPMAX = 100.
C     IF (ITYPE.EQ.3) AMPMAX = 100.
C END JULY 1993
      IF (AMPLT2.LE.0.) AMPLT2 = AMPMAX
      IF (AMPLT2.GT.AMPMAX) AMPLT2 = AMPMAX
      IF (EIGGNP.EQ.0.0) AMPLT2 = 0.
C END APRIL 1990
C BEG JUNE 1991
      IF (IPFCE.GE.1) THEN
C BEG OCT 1996
         WRITE(IFILE,39) AMPLIT,AMPLT2,AMPAMG,AMPLT3
   39    FORMAT(/' BOWING AMPLIFICATION FACTORS:'/
     1           '   Amplification factor for global axial bowing'/
     1           '    from global imperfection            =',1P,E12.4/
     1           '   Amplification factor for global axial bowing'/
     1           '    from normal pressure                =',1P,E12.4/
     1           '   Amplification factor for axial bowing from'/
     1           '    thermal residual deformation or edge moments'/
     1           '                                        =',1P,E12.4/
     1           '   Amplification factor for inter-ring axial'/
     1           '    bowing                              =',1P,E12.4)
C END OCT 1996
      ENDIF
C END JUNE 1991
   40 CONTINUE
C
C BEG 26 JAN 1989 and 1 MAY 1989
C BEG APRIL 1990
      FACTMP = 1.0
C BEG NOV 1992
      IF (IBPRE.GE.1.AND.IBOUND.EQ.1) FACTMP = 0.5
      BOW3 = 0.
      BOW4 = 0.
C BEG JUN 1999
      FMPLT2 = AMPLT2
      IF (FMPLT2.LT.1.0) FMPLT2 = 1.0
      IF (IBLL.EQ.0) THEN
C BEG JULY 1993
         IF (.NOT.LGSTF2) THEN
C         BOW3 = FACTMP*(WRESID(1) + FACTMX*WIMPG + BOWMX)
          BOW3 = FACTMP*(WRESID(1) + FMULTX*FACTMX*WIMPG 
     1                             + FMULTX*(FMPLT2-1.)*BOWMX)
          IF (LGSTF3) BOW3 = FMULTX*FACTMX*W0PAN
         ENDIF
         IF ((.NOT.PEDG).AND.(.NOT.LGSTF1))
C    1       BOW4 = WRESID(2) + FACTMX*WIMPG + BOWMY
     1       BOW4 = WRESID(2) + FMULTY*FACTMX*WIMPG
     1                        + FMULTY*(FMPLT2-1.)*BOWMY
C END JUN 1999
C END JULY 1993
      ENDIF
      FCTAMP = 1.0
C     IF (.NOT.PEDG.AND.IBPRE.GE.1.AND.AMPLT2.GT.0.) FCTAMP=1./AMPLT2
C     IF (.NOT.PEDG.AND.IBPRE.GE.1.AND.ISTIF(1).NE.5
C    1           .AND.ISTIF(1).NE.0.AND.AMPLT2.GT.0.) FCTAMP=0./AMPLT2
C BEG JULY 1995
C     IF (IBPRE.GE.1.AND.ISTIF(1).NE.5
C    1           .AND.ISTIF(1).NE.0.AND.AMPLT2.GT.0.) FCTAMP=0./AMPLT2
      IF (IBPRE.GE.1.AND.ISTIF(1).NE.5.AND.ISOGRD.EQ.0
     1           .AND.ISTIF(1).NE.0.AND.AMPLT2.GT.0.) FCTAMP=0./AMPLT2
C END JULY 1995
      IF (PEDG.AND.P.NE.0.) FCTAMP = 0./AMPLT2
      BOW1 = 0.
      BOW2 = 0.
      IF (IBLL.EQ.0) THEN
C BEG JULY 1993
         IF (.NOT.LGSTF2) THEN
C BEG OCT 1996
C           BOW1 = BOW3*AMPLIT + WPRESG*AMPLT2*FCTAMP
C BEG JUN 1999
            BOW1 = BOW3*AMPAMG + WPRESG*AMPLT2*FCTAMP*FMULTX
C END OCT 1996
C BEG JULY 1995
            IF (LGSTF3) BOW1 = BOW3*AMPLT3 +WPRESG*FCTAMP*FMULTX
C END JULY 1995
         ENDIF
         IF ((.NOT.PEDG).AND.(.NOT.LGSTF1))
C BEG OCT 1996
C    1       BOW2 = BOW4*AMPLIT + WPRESG*AMPLT2*FCTAMP
     1       BOW2 = BOW4*AMPAMG + WPRESG*AMPLT2*FCTAMP*FMULTY
C END OCT 1996
C END JUN 1999
C END JULY 1993
      ENDIF
C END NOV 1992
C     WRITE(8,*)' IBPRE,AMPLT2,FCTAMP,WPRESG,PEDG=',
C    1            IBPRE,AMPLT2,FCTAMP,WPRESG,PEDG
C END MAR 1991
C BEG JULY 1993
      IF (ICASE.EQ.2) THEN
         BOW1 = -BOW1
C BEG JULY 1995
         IF (ISTIF(2).EQ.0) BOW2 = 0.
C END JULY 1995
         BOW3 = -BOW3
C BEG JULY 1995
         IF (ISTIF(2).EQ.0) BOW4 = 0.
C END JULY 1995
         IF (LGSTF3) THEN
            BOW1 = 0.
            BOW2 = 0.
            BOW3 = 0.
            BOW4 = 0.
         ENDIF
C BEG JUN 1999
         IF (ISTIF(2).EQ.0.AND.IBPRE.EQ.0) THEN
            BOW1 = 0.
            BOW3 = 0.
         ENDIF
C END JUN 1999
      ENDIF
C END JULY 1993
C BEG AUG 1992
      FCTBW1 = 1.0
      IF (NX.GT.0.0) FCTBW1 = 0.
      FCTBW2 = 1.0
      IF (NY.GT.0.0) FCTBW2 = 0.
C BEG NOV 1992
      APPLOD(4) = 0.
      APPLOD(5) = 0.
      IF (IBLL.EQ.0) THEN
C BEG JULY 1993
         IF (.NOT.LGSTF2) THEN
C BEG JUN 1999
            APPLOD(4) =FCTBW1*NX*BOW1 
     1                -NX*(DNEUTX+FMPLT2*ECC) + MX
            IF (LGSTF3) APPLOD(4) = FCTBW1*NX*BOW1 -NX*DNEUTX
         ENDIF
         IF ((.NOT.PEDG).AND.(.NOT.LGSTF1))
     1      APPLOD(5) =FCTBW2*NY*BOW2
     1                -NY*(DNEUTY+FMPLT2*ECCY) + MY
C END JUN 1999
C END JULY 1993
      ENDIF
C END NOV 1992
C END AUG 1992
C END APRIL 1990
C BEG NOV 1992
      APPLOD(6) = 0.
      IF (IBLL.EQ.0) APPLOD(6) = NXY*CS(3,6)/CS(3,3)
C END NOV 1992
C     IF (ISTIF(1).EQ.5) APPLOD(6) = -NXY*(DNEUTX+CS(3,6)/CS(3,3))
C     IF (ISTIF(2).EQ.5) APPLOD(6) = -NXY*(DNEUTY+CS(3,6)/CS(3,3))
C BEG AUG 1992
      FCTBW1 = 1.0
      IF (NX0.GT.0.0) FCTBW1 = 0.
      FCTBW2 = 1.0
      IF (NY0.GT.0.0) FCTBW2 = 0.
C BEG NOV 1992
      FIXLOD(4) = 0.
      FIXLOD(5) = 0.
      IF (IBLL.EQ.0) THEN
C BEG JULY 1993
         IF (.NOT.LGSTF2) THEN
C BEG OCT 1996
C           FIXLOD(4) =FCTBW1*NX0*BOW3*AMPLIT -NX0*(DNEUTX+AMPLT2*ECC)
C BEG JUN 1999
            FIXLOD(4) =FCTBW1*NX0*BOW3*AMPAMG
     1                -NX0*(DNEUTX+AMPLT2*ECC)
C END OCT 1996
            IF (LGSTF3) FIXLOD(4)=FCTBW1*NX0*BOW3*AMPLT3
     1                            - NX0*DNEUTX
         ENDIF
         IF ((.NOT.PEDG).AND.(.NOT.LGSTF1))
C BEG OCT 1996
C    1      FIXLOD(5) =FCTBW2*NY0*BOW4*AMPLIT -NY0*DNEUTY
     1      FIXLOD(5) =FCTBW2*NY0*BOW4*AMPAMG -NY0*DNEUTY
C END OCT 1996
C END JUN 1999
C END JULY 1993
      ENDIF
C END NOV 1992
C END AUG 1992
      FIXLOD(6) = 0.
C END 26 JAN 1989 and 1 MAY 1989
C
C  CALCULATE SHEAR IN STIFFENER WEBS CAUSED BY BOWING AND ECCENTRIC
C  LOAD APPLICATION...
C
      IF (MIDEND.EQ.2) THEN
C BEG NOV 1992
         FMOMX = 0.
         FMOMY = 0.
         IF (IBLL.EQ.0) THEN
C BEG JULY 1993
            IF (.NOT.LGSTF2)
C BEG JUN 1999
     1        FMOMX = APPLOD(4) + FIXLOD(4) +(NX+NX0)*DNEUTX
            IF ((.NOT.PEDG).AND.(.NOT.LGSTF1))
     1        FMOMY = APPLOD(5) + FIXLOD(5) +(NY+NY0)*DNEUTY
C END JUN 1999
C END JULY 1993
         ENDIF
         IF (ISTIF(1).NE.0.AND.FMOM.EQ.0.0
     1                    .AND.ISOGRD.EQ.0.AND.IBLL.EQ.0)
     1      CALL SHRBOW(IFILE,1,FMOMX,FMOMY,IMOD,JJJ)
         IF (ISTIF(2).NE.0.AND.FMOM.EQ.0.0.AND.IBLL.EQ.0)
     1      CALL SHRBOW(IFILE,2,FMOMX,FMOMY,IMOD,JJJ)
C END NOV 1992
      ENDIF
C
C     WRITE(IFILE,*)' IN FORCES...SHEARX,SHEARY=',SHEARX,SHEARY
C
C  NEXT, GET THE SOLUTION VECTOR, EPSLOD...
C
   50 CONTINUE
C
C BEG APRIL 1990
      CALL MOVER(CS,1,CSTEMP,1,36)
C     CSTEMP(2,2) = 10**6*CSTEMP(2,2)
      CALL STRTHM(24,1,EPSLOD,CSTEMP,CSINV,APPLOD)
      CALL STRTHM(25,0,EPSLD0,CSTEMP,CSINV,FIXLOD)
C END APRIL 1990
C
C BEG APR 1992
C BEG MARCH 1990
C BEG AUG 1993
      IF (PEDG.AND.MY.EQ.0.0.AND.BOW1.NE.0.0) THEN
C  CORRECT STRAINS AND CURVATURE CHANGES IF PANEL IS CYLINDRICAL
C  (THE HOOP CURVATURE CHANGE IS REMOVED BY APPLICATION OF A HOOP
C  MOMENT ONLY (OTHER FORCES ARE ASSUMED TO BE ZERO)...
         DO 549 I = 1,5
           EPSLOD(I) =EPSLOD(I) - CSINV(I,5)*EPSLOD(5)/CSINV(5,5)
           EPSLD0(I) =EPSLD0(I) - CSINV(I,5)*EPSLD0(5)/CSINV(5,5)
  549    CONTINUE
      ENDIF
C END MARCH 1990
C END AUG 1993
C BEG AUG 1992
C BEG NOV 1992
      IF (BOW1.EQ.0.0.AND.(PEDG.OR.IBPRE.GE.1)) THEN
C END NOV 1992
C  PURPOSE IS TO ELIMINATE BENDING AND TWISTING UNDER IN-PLANE LOADS
C  IF THE PANEL IS CURVED (PEDG) OR IF IT IS CLAMPED (IBPRE=1 OR 2).
         DO 53 I = 1,3
         II = I + 3
         DO 53 J = 1,3
         JJ = J + 3
   53    C33REG(I,J) = CSINV(II,JJ)
         CALL INVERT(C33REG,3,ISING)
         IF (ISING.NE.0) THEN
            WRITE(IFILE,*)' 3X3 BENDING DIJ MATRIX IS SINGULAR.'
            CALL ERREX
         ENDIF
         DMX = -(C33REG(1,1)*EPSLOD(4) +C33REG(1,2)*EPSLOD(5)
     1                                 +C33REG(1,3)*EPSLOD(6)) 
         DMY = -(C33REG(1,2)*EPSLOD(4) +C33REG(2,2)*EPSLOD(5)
     1                                 +C33REG(2,3)*EPSLOD(6)) 
         DMXY= -(C33REG(1,3)*EPSLOD(4) +C33REG(2,3)*EPSLOD(5)
     1                                 +C33REG(3,3)*EPSLOD(6)) 
         DO 55 I = 1,6
            EPSLOD(I) = EPSLOD(I) + CSINV(I,4)*DMX + CSINV(I,5)*DMY
     1                                             + CSINV(I,6)*DMXY
   55    CONTINUE
         DMX = -(C33REG(1,1)*EPSLD0(4) +C33REG(1,2)*EPSLD0(5)
     1                                 +C33REG(1,3)*EPSLD0(6)) 
         DMY = -(C33REG(1,2)*EPSLD0(4) +C33REG(2,2)*EPSLD0(5)
     1                                 +C33REG(2,3)*EPSLD0(6)) 
         DMXY= -(C33REG(1,3)*EPSLD0(4) +C33REG(2,3)*EPSLD0(5)
     1                                 +C33REG(3,3)*EPSLD0(6)) 
         DO 56 I = 1,6
            EPSLD0(I) = EPSLD0(I) + CSINV(I,4)*DMX + CSINV(I,5)*DMY
     1                                             + CSINV(I,5)*DMXY
   56    CONTINUE
C END AUG 1992
      ENDIF
C END APR 1992
C
C BEG JULY 1989
C        WRITE(8,*)' WIMPG,WRESID(1),WPRESG,ECC,AMPLIT,BOWMX,BOWMY=',
C    1               WIMPG,WRESID(1),WPRESG,ECC,AMPLIT,BOWMX,BOWMY
C        WRITE(8,*)' DNEUTX,DNEUTY,BOW1,BOW2,MX,MY=',
C    1               DNEUTX,DNEUTY,BOW1,BOW2,MX,MY
C        WRITE(8,*)' CS(1,1),CS(2,2),CS(3,3),CS(4,4),CS(5,5),CS(6,6)=',
C    1               CS(1,1),CS(2,2),CS(3,3),CS(4,4),CS(5,5),CS(6,6)
C        WRITE(8,*)' CS(1,2),CS(1,4),CS(1,5),CS(2,4),CS(2,5),CS(3,6)=',
C    1               CS(1,2),CS(1,4),CS(1,5),CS(2,4),CS(2,5),CS(3,6)
C        WRITE(8,*)' (APPLOD(I),I=1,6)=',APPLOD(1),APPLOD(2),APPLOD(3),
C    1                                   APPLOD(4),APPLOD(5),APPLOD(6)
C        WRITE(8,*)' (EPSLOD(I),I=1,6)=',EPSLOD(1),EPSLOD(2),EPSLOD(3),
C    1                                   EPSLOD(4),EPSLOD(5),EPSLOD(6)
C END JULY 1989
C
C  PLACE LIMITS ON CURVATURE CHANGE FOR TENSILE FORCES...
C
      ETHSM4 = ETHERM(4) + EAVEP(4) + EAVEPL(4)
      ETHSM5 = ETHERM(5) + EAVEP(5) + EAVEPL(5)
C BEG MARCH 1990  (FOLLOWING 12 STATEMENTS ARE COMMENTED OUT...)
C     IF (NX.GT.0.) THEN
C        IF (ABS(EPSLOD(4)).GT.ABS(ETHSM4)) EPSLOD(4) = - ETHSM4
C     ENDIF
C     IF (NX0.GT.0.) THEN
C        IF (ABS(EPSLD0(4)).GT.ABS(ETHSM4)) EPSLD0(4) = - ETHSM4
C     ENDIF
C     IF (NY.GT.0.) THEN
C        IF (ABS(EPSLOD(5)).GT.ABS(ETHSM5)) EPSLOD(5) = - ETHSM5
C     ENDIF
C     IF (NY0.GT.0.) THEN
C        IF (ABS(EPSLD0(5)).GT.ABS(ETHSM5)) EPSLD0(5) = - ETHSM5
C     ENDIF
C
C  AMPLIFICATION OF INITIAL BOWING AT THE CENTER OF THE PANEL...
C
C BEG 26 JAN 1989
C BEG APRIL 1990
C BEG NOV 1991
      WBEND = BOW1/FACTMP
C END NOV 1991
C END APRIL 1990
C END 26 JAN 1989
C BEG JULY 1995
      EPSLOD(1) = EPSLOD(1) + FEPS1
      EPSLOD(2) = EPSLOD(2) + FEPS2
      EPSLOD(5) = EPSLOD(5) + CURVY
C END JULY 1995
C
C*******************************************************************
C END MISCELLANEOUS CALCULATIONS AND INITIALIZATIONS.
C*******************************************************************
C
C
C*******************************************************************
C BEGIN CALCULATIONS OF STRAINS, CHANGES IN CURVATURE, AND RESULTANTS
C IN ALL SEGMENTS OF THE SKIN-STRINGER PANEL MODULE AND SKIN-RING PANEL
C MODULE.
C*******************************************************************
C
C
   60 CONTINUE
C
C*******************************************************************
C BEGIN CALCULATIONS FOR STRAINS AND CHANGES IN CURVATURE IN SEGMENTS
C 1 AND 2 OF THE PANEL SKIN (SEG. 2 IS THE BASE UNDER THE STIFFENER.
C*******************************************************************
C
C BEG AUG 1992
      IF (ISOGRD.EQ.1) THEN
         DO 62 I = 1,6
            EP(I) = EPSLOD(I)
            EP0(I)= EPSLD0(I)
            EPP(I)= EAVEP(I)
            ET(I) = ETHERM(I)
            EPS(I) = EPSLOD(I)
            EPS0(I)= EPSLD0(I)
            EPSP(I)= EAVEP(I)
            ETH(I) = ETHERM(I)
C BEG OCT 1998
            EPPB(I) = EAVEPB(I)
            EPSPB(I)= EAVEPB(I)
C END OCT 1998
   62    CONTINUE
         CALL EPSSKN(1,1,EPSDUM,EPSDUM,EP(1),EP(2),EP(1),EP(2),0.,
     1          CX,CY,EP(3),EP(3),EP(3),EPSEIG,EPSDUM,EPSDUM,ISTIF)
         CALL EPSSKN(1,1,EPSDUM,EPSDUM,EP0(1),EP0(2),EP0(1),EP0(2),0.,
     1          CX,CY,EP0(3),EP0(3),EP0(3),EPSFXL,EPSDUM,EPSDUM,ISTIF)
         CALL EPSSKN(1,1,EPSDUM,EPSDUM,EPP(1),EPP(2),EPP(1),EPP(2),0.,
     1          CX,CY,EPP(3),EPP(3),EPP(3),EPSPGL,EPSDUM,EPSDUM,ISTIF)
C BEG OCT 1998
         CALL EPSSKN(1,1,EPSDUM,EPSDUM,EPPB(1),EPPB(2),EPPB(1),EPPB(2),
     1     0.,CX,CY,EPPB(3),EPPB(3),EPPB(3),EPSBGL,EPSDUM,EPSDUM,ISTIF)
C END OCT 1998
         CALL EPSSKN(1,1,ETHRMX,ETHRMY,ET(1),ET(2),ET(1),ET(2),0.,
     1          CX,CY,ET(3),ET(3),ET(3),EPSFIX,ETSMRX,ETSMRY,ISTIF)
         GO TO 65
      ENDIF
C END AUG 1992
C  GET STRAIN AND CURVATURE CHANGE DISTRIBUTION FOR EIGENVALUE LOADS..
C
      CALL STRDIS(1,1,0.,FSTRN(1,1,5),GSTRN(1,1,5),B,B2,W2,EPSLOD,CX,CY,
     1           THERMX,THERMY,EP121L,EP122L,EP123L,NXY,
C BEG JULY 1989
     1           EX3L, EY2L, EX2L, EY3L, KX3L, KY2L, KX2L, KY3L, ISTIF)
C END JULY 1989
C
C     WRITE(8,*)' EPSLOD(1,2)=         ', EPSLOD(1),EPSLOD(2)
C     WRITE(8,*)' EPSLOD(4,5)=         ', EPSLOD(4),EPSLOD(5)
C     WRITE(8,*)' EPSLOD(3,6)=         ', EPSLOD(3),EPSLOD(6)
C     WRITE(8,*)' EP121L,EP122L,EP123L=', EP121L,EP122L,EP123L
C     WRITE(8,*)' EX2L,EX3L,EY2L,EY3L =', EX2L,EX3L,EY2L,EY3L
C     WRITE(8,*)' KX2L,KX3L,KY2L,KY3L =', KX2L,KX3L,KY2L,KY3L
C
C  GET STRAIN AND CURVATURE CHANGE DISTRIBUTION FOR FIXED LOADS...
C
      CALL STRDIS(1,1,0.,FSTRN(1,1,5),GSTRN(1,1,5),B,B2,W2,EPSLD0,CX,CY,
     1           THERMX,THERMY,ES1L0,ES2L0,ES3L0,0.,
C BEG JULY 1989
     1           EX3L0,EY2L0,EX2L0,EY3L0,KX3L0,KY2L0,KX2L0,KY3L0,ISTIF)
C END JULY 1989
C
C  GET STRAIN AND CURVATURE CHANGE DISTRIBUTION FROM NORMAL PRESSURE...
C
C BEG APR 1992
      IFS = 5
      IF (PEDG.AND.ISTIF(2).NE.0.AND.ICASE.EQ.1) IFS = 1
      CALL STRDIS(1,1,0.,FSTRN(1,1,IFS),GSTRN(1,1,IFS),B,B2,W2,EAVEP,
     1           CX,CY,THERMX,THERMY,EP121P,EP122P,EP123P,0.,
     1           EX3P, EY2P, EX2P, EY3P, KX3P, KY2P,KX2P,KY3P,ISTIF)
C BEG OCT 1998
      CALL STRDIS(1,1,0.,FSTRN(1,1,IFS),GSTRN(1,1,IFS),B,B2,W2,EAVEPB,
     1           CX,CY,THERMX,THERMY,EP121B,EP122B,EP123B,0.,
     1           EX3B, EY2B, EX2B, EY3B, KX3B, KY2B,KX2B,KY3B,ISTIF)
C END OCT 1998
C END APR 1992
C
      CALL EPSSKN(1,1,EPSDUM,EPSDUM,EX2L, EY3L, EX3L, EY2L, NXY,CX,CY,
     1            EP121L,EP122L,EP123L,EPSEIG,EPSDUM,EPSDUM,ISTIF)
      CALL EPSSKN(1,1,EPSDUM,EPSDUM,EX2L0,EY3L0,EX3L0,EY2L0,0., CX,CY,
     1            ES1L0,ES2L0,ES3L0,EPSFXL,EPSDUM,EPSDUM,ISTIF)
      CALL EPSSKN(1,1,EPSDUM,EPSDUM,EX2P, EY3P, EX3P, EY2P, 0., CX,CY,
     1            EP121P,EP122P,EP123P,EPSPGL,EPSDUM,EPSDUM,ISTIF)
C BEG OCT 1998
      CALL EPSSKN(1,1,EPSDUM,EPSDUM,EX2B, EY3B, EX3B, EY2B, 0., CX,CY,
     1            EP121B,EP122B,EP123B,EPSBGL,EPSDUM,EPSDUM,ISTIF)
C END OCT 1998
C
   70 CONTINUE
C
C  GET STRAIN AND CURVATURE CHANGE DISTRIBUTION FOR THERMAL LOADS...
C
C BEG NOV 1992
      IFS = 4
      IF (ICODIF(1)) IFS = 4
      IF (ICODIF(2)) IFS = 4
      CALL STRDIS(1,1,1.,FSTRN(1,1,IFS),GSTRN(1,1,IFS),
     1     B,B2,W2,ETHERM,CX,CY,THERMX,THERMY,EP121T,EP122T,EP123T,0.,
     1     EX3T,EY2T,EX2T,EY3T,KX3T,KY2T,KX2T,KY3T,ISTIF)
C     WRITE(8,1008) EX3T,EY2T,EX2T,EY3T,KX3T,KY2T,KX2T,KY3T
C1008 FORMAT(/' THERMAL STRAINS FROM STRDIS IN FORCES:'/
C    1 ' EX3T,EY2T,EX2T,EY3T=',/1P,4E12.4/
C    1 ' KX3T,KY2T,KX2T,KY3T=',/1P,4E12.4)
C     WRITE(8,*)' ICODIF(1),ICODIF(2)=', ICODIF(1),ICODIF(2)
C     IF (ICODIF(2)) THEN
C     WRITE(8,*)' ICOCUR(1),ICOCUR(2)=',ICOCUR(1),ICOCUR(2)
C BEG JUN 1996
      IF (ISTIF(1).NE.0.AND.ISTIF(2).NE.0.AND.
     1   ICOCUR(1).EQ.0.AND.ICOCUR(2).EQ.1) THEN
C END JUN 1996
         CALL EPSSKN(1,1,ETHRMX,ETHRMY,
     1            EX2T,EY3T,EX3T,EY2T,0., CX,CY,
     1            EP121T,EP122T,EP123T,EPSFIX,ETHRMX,ETSMRY,ISTIF)
      ELSE
         CALL EPSSKN(1,1,ETHRMX,ETHRMY,
     1            EX2T,EY3T,EX3T,EY2T,0., CX,CY,
     1            EP121T,EP122T,EP123T,EPSFIX,ETSMRX,ETSMRY,ISTIF)
      ENDIF
C     WRITE(8,1009)(((EPSFIX(I,J,K),I=1,3),J=1,4),K=1,2)
C1009 FORMAT(/' THERMAL STRAINS, EPSFIX(I,J,K)='/
C    1        (' AXIAL,HOOP,SHEAR=',1P,3E12.4))
C END NOV 1992
C
C
C*******************************************************************
C END CALCULATIONS FOR STRAINS AND CHANGES IN CURVATURE IN SEGMENTS
C 1 AND 2 OF THE PANEL SKIN (SEG. 2 IS THE BASE UNDER THE STIFFENER.
C*******************************************************************
C
C  NEXT, CALCULATE RESULTANTS IN EACH PART OF THE PANEL...
C
C******************************************************************
C  BEGIN CALCULATIONS OF RESULTANTS IN SEGMENT 1 OF THE PANEL SKIN.
C******************************************************************
C  FIRST, THE RESULTANTS IN THE SKIN...
C
   80 CONTINUE
C
      EP(1) = EX2L
      EP(2) = EY3L
      EP(3) = EP121L
      EP(4) = KX2L
      EP(5) = KY3L
      EP(6) = EPSLOD(6)
C
      EP0(1)= EX2L0
      EP0(2)= EY3L0
C BEG MARCH 1990
      EP0(3)= ES1L0
C END MARCH 1990
      EP0(4)= KX2L0
      EP0(5)= KY3L0
      EP0(6)= EPSLD0(6)
C
      EPP(1)= EX2P
      EPP(2)= EY3P
      EPP(3)= EP121P
      EPP(4)= KX2P
      EPP(5)= KY3P
      EPP(6)= EAVEP(6)
C BEG OCT 1998
C
      EPPB(1)= EX2B
      EPPB(2)= EY3B
      EPPB(3)= EP121B
      EPPB(4)= KX2B
      EPPB(5)= KY3B
      EPPB(6)= EAVEPB(6)
C     WRITE(8,'(A,/,1P,6E12.4)')' EAVEPB(1),...EAVEPB(6)=',
C    1                           (EAVEPB(I),I=1,6)
C     WRITE(8,'(A,/,1P,6E12.4)')' EPPB(1),...EPPB(6)=',
C    1                           (EPPB(I),I=1,6)
C END OCT 1998
C
      ET(1) = EX2T  
      ET(2) = EY3T  
      ET(3) = EP121T  
      ET(4) = KX2T  
      ET(5) = KY3T  
      ET(6) = ETHERM(6) 
C BEG AUG 1992
   65 CONTINUE
C END AUG 1992
C
C BEG 26 JAN 1989
      CALL RES(1,1,CX(1,1,1),THSMRX(1,1),EP,0.,NXY,RESEIG)
      CALL RES(1,1,CX(1,1,1),THSMRX(1,1),EP0,0.,0.,RESFXL)
      CALL RES(1,1,CX(1,1,1),THSMRX(1,1),EPP,0.,0.,RESPGL)
C BEG OCT 1998
      CALL RES(1,1,CX(1,1,1),THSMRX(1,1),EPPB,0.,0.,RESBGL)
C END OCT 1998
C BEG NOV 1992
      IF (ISTIF(1).EQ.0.AND.ISTIF(2).NE.0) THEN
C        IF (ICODIF(1)) THEN
C BEG JUN 1996
C        IF (ICOCUR(1).EQ.1.AND.ICOCUR(2).EQ.0) THEN
C           CALL MOVER(0.,0,THDUM,1,6)
C           CALL RES(1,1,CX(1,1,1),THDUM,ET,1.,0.,RESFIX)
C        ELSE
            CALL RES(1,1,CX(1,1,1),THSMRX(1,1),ET,1.,0.,RESFIX)
C        ENDIF
C END JUN 1996
      ELSE
C        IF (ISTIF(1).NE.0.AND.ISTIF(2).NE.0.AND.ICODIF(2)) THEN
         IF (ISTIF(1).NE.0.AND.ISTIF(2).NE.0
     1                    .AND.ICOCUR(1).EQ.0.AND.ICOCUR(2).EQ.1) THEN
            CALL RES(1,1,CX(1,1,1),THERMX(1,1),ET,1.,0.,RESFIX)
         ELSE
            CALL RES(1,1,CX(1,1,1),THSMRX(1,1),ET,1.,0.,RESFIX)
         ENDIF
      ENDIF
C END NOV 1992
C END 26 JAN 1989
C
C
C******************************************************************
C  END CALCULATIONS OF RESULTANTS IN SEGMENT 1 OF THE PANEL SKIN.
C******************************************************************
C
C
C******************************************************************
C  BEGIN CALCULATIONS OF RESULTANTS IN SEGMENT 2 OF THE PANEL SKIN
C  IN THE NEIGHBORHOOD OF THE STRINGER (SEG. 2 IS THE STRINGER BASE)
C******************************************************************
C
  100 CONTINUE
C
C  NEXT, THE RESULTANTS
C  IN SEGMENT 2 (THICKENED REGION UNDER STIFFENER). IT IS ASSUMED
C  THAT THE AXIAL STRAIN IS UNIFORM IN THIN AND THICK PARTS AND THE
C  TRANSVERSE IN-PLANE RESULTANT IS UNIFORM IN THIN AND THICK PARTS..
C
  110 CONTINUE
C
      IF (NSEG(1).GT.1) THEN
C BEG AUG 1992
         IF (ISOGRD.EQ.1) GO TO 112
C END AUG 1992
         ETH(1) = EX2T  
         ETH(2) = EY2T  
         ETH(3) = EP122T 
         ETH(4) = KX2T  
         ETH(5) = KY2T  
         ETH(6) = ETHERM(6) 
C
         EPS(1) = EX2L
         EPS(2) = EY2L
         EPS(3) = EP122L
         EPS(4) = KX2L
         EPS(5) = KY2L
         EPS(6) = EPSLOD(6)
C
         EPS0(1) = EX2L0
         EPS0(2) = EY2L0
C BEG MARCH 1990
         EPS0(3) = ES2L0
C END MARCH 1990
         EPS0(4) = KX2L0
         EPS0(5) = KY2L0
         EPS0(6) = EPSLD0(6)
C
         EPSP(1) = EX2P
         EPSP(2) = EY2P
         EPSP(3) = EP122P
         EPSP(4) = KX2P
         EPSP(5) = KY2P
         EPSP(6) = EAVEP(6)
C BEG OCT 1998
C
         EPSPB(1) = EX2B
         EPSPB(2) = EY2B
         EPSPB(3) = EP122B
         EPSPB(4) = KX2B
         EPSPB(5) = KY2B
         EPSPB(6) = EAVEPB(6)
C END OCT 1998
C
C BEG AUG 1992
  112    CONTINUE
C END AUG 1992
C BEG 26 JAN 1989 
C BEG JULY 1989
         IF (ISTIF(1).NE.5) THEN
            CALL RES(2,1,CX(1,1,2),THSMRX(1,2),EPS,0.,NXY,RESEIG)
            CALL RES(2,1,CX(1,1,2),THSMRX(1,2),EPS0,0.,0.,RESFXL)
            CALL RES(2,1,CX(1,1,2),THSMRX(1,2),EPSP,0.,0.,RESPGL)
C BEG OCT 1998
            CALL RES(2,1,CX(1,1,2),THSMRX(1,2),EPSPB,0.,0.,RESBGL)
C END OCT 1998
            CALL RES(2,1,CX(1,1,2),THSMRX(1,2),ETH,1.,0. ,RESFIX)
C BEG NOV 1992
C           IF (ICODIF(2)) THEN
            IF (ICOCUR(1).EQ.0.AND.ICOCUR(2).EQ.1) THEN
               RESFIX(1,2,1) = RESFIX(1,1,1)
               RESFIX(2,2,1) = RESFIX(2,1,1)
               RESFIX(3,2,1) = RESFIX(3,1,1)
            ENDIF
C END NOV 1992
         ENDIF
C END JULY 1989
C END 26 JAN 1989
      ENDIF
C
C******************************************************************
C  END CALCULATIONS OF RESULTANTS IN SEGMENT 2 OF THE PANEL SKIN
C  IN THE NEIGHBORHOOD OF THE STRINGER (SEG. 2 IS THE STRINGER BASE)
C******************************************************************
C
C
  120 CONTINUE
C
C******************************************************************
C  BEGIN CALCULATIONS FOR AVERAGE STRAINS, RSULTANTS AND TOTAL
C  STIFFNESSES IN WEB AND FLANGE OF THE STRINGER.
C******************************************************************
C
C
C  NEXT, GET RESULTANTS AND TOTAL FORCES IN WEB AND FLANGE OF
C  STRINGER...
C
C BEG 26 JAN 1989
C BEG JULY 1989
      IWEB = 3
      IF (ISTIF(1).EQ.5) IWEB = 2
      IWEBP = IWEB + 1
      IWEBM = IWEB - 1
C BEG AUG 1992
      IF (ISOGRD.EQ.1) THEN
         THETA = 30.*PI/180.
         IF (ISOANG.EQ.2) THETA = 60.*PI/180.
         STHET = SIN(THETA)
         CTHET = COS(THETA)
         DO 114 I = 1,3
            IF (I.EQ.2) STHET = -STHET
            IF (I.EQ.3) THEN
               IF (ISOANG.EQ.1) THEN
                  STHET = 1.0
                  CTHET = 0
               ELSE
                  STHET = 0.
                  CTHET = 1.
               ENDIF
            ENDIF
            CTHET2 = CTHET*CTHET
            SCTHET = STHET*CTHET
            STHET2 = STHET*STHET
C
            ERIB = EPS(1)*CTHET2 +EPS(2)*STHET2 +EPS(3)*SCTHET
            CUR1 = EPSLOD(4)*CTHET2 +EPSLOD(5)*STHET2 +EPSLOD(6)*SCTHET
            CALL WEBFLN(0.,ERIB, CUR1, EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RSEIG(1,IWEB,I),RSEIG(1,IWEBP,I),STIF1L,ESEIG(1,1,I),
     1      RWEIG(I),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EPSLOD(5),EPSLOD(6),0.,FPRESS,WBEIG(1,I,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C
            ERIB = EPS0(1)*CTHET2 +EPS0(2)*STHET2 +EPS0(3)*SCTHET
            CUR1 = EPSLD0(4)*CTHET2 +EPSLD0(5)*STHET2 +EPSLD0(6)*SCTHET
            CALL WEBFLN(0.,ERIB, CUR1, EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RSFXL(1,IWEB,I),RSFXL(1,IWEBP,I),STIF1L,ESFXL(1,1,I),
     1      RWFXL(I),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EPSLD0(5),EPSLD0(6),0.,FPRESS,WBFXL(1,I,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C
            ERIB = EPSP(1)*CTHET2 +EPSP(2)*STHET2 +EPSP(3)*SCTHET
            CUR1 = EAVEP(4)*CTHET2 +EAVEP(5)*STHET2 +EAVEP(6)*SCTHET
            CALL WEBFLN(0.,ERIB, CUR1, EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RSPGL(1,IWEB,I),RSPGL(1,IWEBP,I),STIF1L,ESPGL(1,1,I),
     1      RWPGL(I),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EAVEP(5),EAVEP(6),P,FPRESS,WBPGL(1,I,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C BEG OCT 1998
C
            ERIB = EPSPB(1)*CTHET2 +EPSPB(2)*STHET2 +EPSPB(3)*SCTHET
            CUR1 = EAVEPB(4)*CTHET2 +EAVEPB(5)*STHET2 +EAVEPB(6)*SCTHET
            IF (PEDG) CALL WEBFLN(0.,ERIB, CUR1, EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RSBGL(1,IWEB,I),RSBGL(1,IWEBP,I),STIF1L,ESBGL(1,1,I),
     1      RWBGL(I),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EAVEPB(5),EAVEPB(6),P,FPRESS,WBBGL(1,I,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C END OCT 1998
C
            ERIB = ETHERM(1)*CTHET2 +ETHERM(2)*STHET2 +ETHERM(3)*SCTHET
            CUR1 = ETHERM(4)*CTHET2 +ETHERM(5)*STHET2 +ETHERM(6)*SCTHET
C BEG NOV 1992
            IF (ICODIF(2)) THEN
C           IF (ICOCUR(1).EQ.0.AND.ICOCUR(2).EQ.1) THEN
               ERIB = 0.
               CUR1 = 0.
            ENDIF
C END NOV 1992
            CALL WEBFLN(1.,ERIB, CUR1, ETHRMX,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RSFIX(1,IWEB,I),RSFIX(1,IWEBP,I),STIF1T,ESFIX(1,1,I),
     1      RWFIX(I),THSMRX,ETSMRX,ET3X,TT3X,TX(IWEBM),
     1      ETHERM(5),ETHERM(6),0.,FPRESS,WBFIX(1,I,1),
     1      CX3,TSMRX3,NNODES,TEMP(IWEBM,1),TEMP(IWEBP,1),IMTEMP)
C
  114    CONTINUE
         IF (ISOANG.EQ.1) THEN
            RSPGL(2,IWEB,3) = POPISO
C           IF (POPISO.GT.0.0.AND.CX(2,2,IWEB).NE.0.0)
            IF (CX(2,2,IWEB).NE.0.0)
     1         ESPGL(2,IWEB,3) =ESPGL(2,IWEB,3)+POPISO/CX(2,2,IWEB)
         ELSE
            RSPGL(2,IWEB,1) = POPISO
C           IF (POPISO.GT.0.0.AND.CX(2,2,IWEB).NE.0.0)
            IF (CX(2,2,IWEB).NE.0.0)
     1         ESPGL(2,IWEB,1) =ESPGL(2,IWEB,1)+POPISO/CX(2,2,IWEB)
            RSPGL(2,IWEB,2) = POPISO
C           IF (POPISO.GT.0.0.AND.CX(2,2,IWEB).NE.0.0)
            IF (CX(2,2,IWEB).NE.0.0)
     1         ESPGL(2,IWEB,2) =ESPGL(2,IWEB,2)+POPISO/CX(2,2,IWEB)
         ENDIF
         GO TO 140
      ENDIF
      CALL WEBFLN(0.,EPS(1), EPSLOD(4),EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RESEIG(1,IWEB,1),RESEIG(1,IWEBP,1),STIF1L,EPSEIG(1,1,1),
     1      RWBEIG(1),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EPSLOD(5),EPSLOD(6),0.,FPRESS,WBEIG(1,1,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C
      CALL WEBFLN(0.,EPS0(1),EPSLD0(4),EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RESFXL(1,IWEB,1),RESFXL(1,IWEBP,1),STIF1L,EPSFXL(1,1,1),
     1      RWBFXL(1),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EPSLD0(5),EPSLD0(6),0.,FPRESS,WBFXL(1,1,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C
      CALL WEBFLN(0.,EPSP(1),EAVEP(4),EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RESPGL(1,IWEB,1),RESPGL(1,IWEBP,1),STIF1L,EPSPGL(1,1,1),
     1      RWBPGL(1),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EAVEP(5),EAVEP(6),P,FPRESS,WBPGL(1,1,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C BEG OCT 1998
C
      IF (PEDG) CALL WEBFLN(0.,EPSPB(1),EAVEPB(4),EPSDUM,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RESBGL(1,IWEB,1),RESBGL(1,IWEBP,1),STIF1L,EPSBGL(1,1,1),
     1      RWBBGL(1),THSMRX,EPSDUM,ET3X,TT3X,TX(IWEBM),
     1      EAVEPB(5),EAVEPB(6),P,FPRESS,WBBGL(1,1,1),
     1      CX3,TSMRX3,0,0.,0.,0)
C END OCT 1998
C
C     RESPGL(3,IWEB,1) = SHEARX
C
  130 CONTINUE
C
C BEG NOV 1992
      IF (ICODIF(2)) THEN
C     IF (ICOCUR(1).EQ.0.AND.ICOCUR(2).EQ.1) THEN
         CALL WEBFLN(1.,0.0      ,0.0      ,ETHRMX,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RESFIX(1,IWEB,1),RESFIX(1,IWEBP,1),STIF1T,EPSFIX(1,1,1),
     1      RWBFIX(1),THSMRX,ETSMRX,ET3X,TT3X,TX(IWEBM),
     1      0.0      ,0.0      ,0.,FPRESS,WBFIX(1,1,1),
     1      CX3,TSMRX3,NNODES,TEMP(IWEBM,1),TEMP(IWEBP,1),IMTEMP)
      ELSE
         CALL WEBFLN(1.,ETHERM(1),ETHERM(4),ETHRMX,ZPARTX,
     1      THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1      RESFIX(1,IWEB,1),RESFIX(1,IWEBP,1),STIF1T,EPSFIX(1,1,1),
     1      RWBFIX(1),THSMRX,ETSMRX,ET3X,TT3X,TX(IWEBM),
     1      ETHERM(5),ETHERM(6),0.,FPRESS,WBFIX(1,1,1),
     1      CX3,TSMRX3,NNODES,TEMP(IWEBM,1),TEMP(IWEBP,1),IMTEMP)
      ENDIF
C END NOV 1992
  140 CONTINUE
C END AUG 1992
      RSTIF1 = (STIF1L + STIF1T)*B(1)
C
C
C******************************************************************
C  END CALCULATIONS FOR AVERAGE STRAINS, RSULTANTS AND TOTAL
C  STIFFNESSES IN WEB AND FLANGE OF THE STRINGER.
C******************************************************************
C
C  FOLLOW SAME LOGIC FOR Y-DIRECTION PANEL MODULE THICK PARTS...
C
  150 CONTINUE
C
C
C******************************************************************
C  BEGIN CALCULATIONS OF RESULTANTS IN SEGMENT 2 OF THE PANEL SKIN
C  IN THE NEIGHBORHOOD OF THE RING (SEG. 2 IS THE RING BASE)
C******************************************************************
C
      IF (NSEG(2).GT.1) THEN
            EPSB(1) = EPSLOD(2)
            EPSB(2) = EPSLOD(1)
            EPSB(3) = EPSLOD(3)
            EPSB(4) = EPSLOD(5)
            EPSB(5) = EPSLOD(4)
            EPSB(6) = EPSLOD(6)
C
            EPSB0(1) = EPSLD0(2)
            EPSB0(2) = EPSLD0(1)
            EPSB0(3) = EPSLD0(3)
            EPSB0(4) = EPSLD0(5)
            EPSB0(5) = EPSLD0(4)
            EPSB0(6) = EPSLD0(6)
C
            CALL MOVER(0.,0,EPSBP,1,6)
               EPSBP(1) = EAVEP(2)
C BEG OCT 1998
               IF (PEDG) EPSBP(1) = EPSRGA
C END OCT 1998
               EPSBP(2) = EAVEP(1)
               EPSBP(3) = EAVEP(3)
               EPSBP(4) = EAVEP(5)
               EPSBP(5) = EAVEP(4)
               EPSBP(6) = EAVEP(6)
C BEG OCT 1998
               EPSBPB(1) = EAVEPB(2)
               IF (PEDG) EPSBPB(1) = EPSRGB
               EPSBPB(2) = EAVEPB(1)
               EPSBPB(3) = EAVEPB(3)
               EPSBPB(4) = EAVEPB(5)
               EPSBPB(5) = EAVEPB(4)
               EPSBPB(6) = EAVEPB(6)
C END OCT 1998
            ETHB(1) = ETHERM(2)
            ETHB(2) = ETHERM(1)
            ETHB(3) = ETHERM(3)
            ETHB(4) = ETHERM(5)
            ETHB(5) = ETHERM(4)
            ETHB(6) = ETHERM(6)
C BEG JULY 1989
         IF (ISTIF(2).NE.5) THEN
            CALL RES(2,2,CY(1,1,2),THSMRY(1,2),EPSB,0.,-NXY,RESEIG)
            CALL RES(2,2,CY(1,1,2),THSMRY(1,2),EPSB0,0.,0., RESFXL)
            CALL RES(2,2,CY(1,1,2),THSMRY(1,2),EPSBP,0.,0., RESPGL)
C BEG OCT 1998
            CALL RES(2,2,CY(1,1,2),THSMRY(1,2),EPSBPB,0.,0.,RESBGL)
C END OCT 1998
            CALL RES(2,2,CY(1,1,2),THSMRY(1,2),ETHB,1.,0.  ,RESFIX)
C BEG NOV 1992
C           IF (ICODIF(1)) THEN
            IF (ICOCUR(1).EQ.1.AND.ICOCUR(2).EQ.0) THEN
               RESFIX(1,2,2) = RESFIX(2,1,1)
               RESFIX(2,2,2) = RESFIX(1,1,1)
               RESFIX(3,2,2) = RESFIX(3,1,1)
            ENDIF
C END NOV 1992
         ENDIF
C END JULY 1989
C END 26 JAN 1989
C
      ENDIF
C
C******************************************************************
C  END CALCULATIONS OF RESULTANTS IN SEGMENT 2 OF THE PANEL SKIN
C  IN THE NEIGHBORHOOD OF THE RING (SEG. 2 IS THE RING BASE)
C******************************************************************
C
C
  160 CONTINUE
C
C
C******************************************************************
C  BEGIN CALCULATIONS FOR AVERAGE STRAINS, RESULTANTS AND TOTAL
C  STIFFNESSES IN WEB AND FLANGE OF THE RING.
C******************************************************************
C
C  NEXT, GET RESULTANTS AND TOTAL FORCE IN WEB AND FLANGE OF RING..
C
C BEG AUG 1992
      IWEB = 3
      IF (ISTIF(2).EQ.5) IWEB = 2
      IWEBP = IWEB + 1
      IWEBM = IWEB - 1
C BEG OCT 1998
      IF (.NOT.PEDG) THEN
         CALL WEBFLN(0.,EPSB(1), EPSLOD(5),EPSDUM,ZPARTY,
     1      THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1      RESEIG(1,IWEB,2),RESEIG(1,IWEBP,2),STIF2L,EPSEIG(1,1,2),
     1      RWBEIG(2),THSMRY,EPSDUM,ET3Y,TT3Y,TY(IWEBM),
     1      EPSLOD(4),EPSLOD(6),0.,FPRESS,WBEIG(1,4,2),
     1      CY3,TSMRY3,0,0.,0.,0)
C
         CALL WEBFLN(0.,EPSB0(1),EPSLD0(5),EPSDUM,ZPARTY,
     1      THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1      RESFXL(1,IWEB,2),RESFXL(1,IWEBP,2),STIF2L,EPSFXL(1,1,2),
     1      RWBFXL(2),THSMRY,EPSDUM,ET3Y,TT3Y,TY(IWEBM),
     1      EPSLD0(4),EPSLD0(6),0.,FPRESS,WBFXL(1,4,2),
     1      CY3,TSMRY3,0,0.,0.,0)
C
         CALL WEBFLN(0.,EPSBP(1),EAVEP(5),EPSDUM,ZPARTY,
     1      THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1      RESPGL(1,IWEB,2),RESPGL(1,IWEBP,2),STIF2L,EPSPGL(1,1,2),
     1      RWBPGL(2),THSMRY,EPSDUM,ET3Y,TT3Y,TY(IWEBM),
     1      EAVEP(4),EAVEP(6),P,FPRESS,WBPGL(1,4,2),
     1      CY3,TSMRY3,0,0.,0.,0)
      ELSE
         CALL WEBFLN(0.,EPSBP(1),EAVEP(5),EPSDUM,ZPARTY,
     1      THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1      RESEIG(1,IWEB,2),RESEIG(1,IWEBP,2),STIF2L,EPSEIG(1,1,2),
     1      RWBEIG(2),THSMRY,EPSDUM,ET3Y,TT3Y,TY(IWEBM),
     1      EAVEP(4),EAVEP(6),P,FPRESS,WBEIG(1,4,2),
     1      CY3,TSMRY3,0,0.,0.,0)
C
         CALL WEBFLN(0.,EPSBPB(1),EAVEPB(5),EPSDUM,ZPARTY,
     1      THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1      RESFXL(1,IWEB,2),RESFXL(1,IWEBP,2),STIF2L,EPSFXL(1,1,2),
     1      RWBFXL(2),THSMRY,EPSDUM,ET3Y,TT3Y,TY(IWEBM),
     1      EAVEPB(4),EAVEPB(6),P,FPRESS,WBFXL(1,4,2),
     1      CY3,TSMRY3,0,0.,0.,0)
      ENDIF
C END OCT 1998
      RESPGL(2,IWEB,2) = POPRNG
C BEG AUG 1992
C     IF (POPRNG.GT.0.0.AND.CY(2,2,IWEB).NE.0.0)
      IF (CY(2,2,IWEB).NE.0.0)
C END AUG 1992
     1     EPSPGL(2,IWEB,2) = EPSPGL(2,IWEB,2) + POPRNG/CY(2,2,IWEB)
C END APR 1992
C
C     RESPGL(3,IWEB,2) = SHEARY
C
  170 CONTINUE
C
C BEG NOV 1992
      IF (ICODIF(1)) THEN
C     IF (ICOCUR(1).EQ.1.AND.ICOCUR(2).EQ.0) THEN
         CALL WEBFLN(1.,0.0      ,0.0      ,ETHRMY,ZPARTY,
     1      THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1      RESFIX(1,IWEB,2),RESFIX(1,IWEBP,2),STIF2T,EPSFIX(1,1,2),
     1      RWBFIX(2),THSMRY,ETSMRY,ET3Y,TT3Y,TY(IWEBM),
     1      0.0      ,0.0      ,0.,FPRESS,WBFIX(1,4,2),
     1      CY3,TSMRY3,NNODES,TEMP(IWEBM,2),TEMP(IWEBP,2),IMTEMP)
      ELSE
         CALL WEBFLN(1.,ETHERM(2),ETHERM(5),ETHRMY,ZPARTY,
     1      THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1      RESFIX(1,IWEB,2),RESFIX(1,IWEBP,2),STIF2T,EPSFIX(1,1,2),
     1      RWBFIX(2),THSMRY,ETSMRY,ET3Y,TT3Y,TY(IWEBM),
     1      ETHERM(4),ETHERM(6),0.,FPRESS,WBFIX(1,4,2),
     1      CY3,TSMRY3,NNODES,TEMP(IWEBM,2),TEMP(IWEBP,2),IMTEMP)
      ENDIF
C END NOV 1992
C END AUG 1992
C
      RSTIF2 = (STIF2L + STIF2T)*B(2)
C
C******************************************************************
C  END CALCULATIONS FOR AVERAGE STRAINS, RESULTANTS AND TOTAL
C  STIFFNESSES IN WEB AND FLANGE OF THE RING.
C******************************************************************
C
C*******************************************************************
C BEGIN IN-PLANE SHEAR RESULTANT IN STIFFENER WEB(S)
C*******************************************************************
C
C BEG JULY 1989
      IWEB1 = 3
      IF (ISTIF(1).EQ.5) IWEB1 = 2
      RESEIG(3,IWEB1,1) = RESEIG(3,IWEB1,1) + SHEARX
      IWEB2 = 3
      IF (ISTIF(2).EQ.5) IWEB2 = 2
      RESEIG(3,IWEB2,2) = RESEIG(3,IWEB2,2) + SHEARY
C BEG  1 MAY 1989
      IF (CX(3,3,IWEB1).GT.0.)
     1   EPSEIG(3,IWEB1,1) = EPSEIG(3,IWEB1,1) + SHEARX/CX(3,3,IWEB1)
      IF (CY(3,3,IWEB2).GT.0.)
     1   EPSEIG(3,IWEB2,2) = EPSEIG(3,IWEB2,2) + SHEARY/CY(3,3,IWEB2)
C END  1 MAY 1989
C END JULY 1989
C
C*******************************************************************
C END IN-PLANE SHEAR RESULTANT IN STIFFENER WEB(S)
C*******************************************************************
C
C*******************************************************************
C END CALCULATIONS OF STRAINS, CHANGES IN CURVATURE, AND RESULTANTS
C IN ALL SEGMENTS OF THE SKIN-STRINGER PANEL MODULE AND SKIN-RING
C PANEL MODULE.
C*******************************************************************
C
C BEG MAR 1997
C     IF (IFX.GT.0.AND.IMOD.EQ.0.AND.JJJ.EQ.0) THEN
      IF (IFX.GT.0.AND.(IMOD.EQ.0.OR.NPRT.GE.2)) THEN
C END MAR 1997
        CALL OUTNX(IFILE,NX,NY,NXY,NX0,NY0,NXY0,EP,EPS,EPSB,ET,ETH,ETHB,
     1             EP0,EPS0,EPSB0,EPP,EPSP,EPSBP,FNXP0,FNYP0,
     1             RESEIG,RESFXL,RESFIX,RESPGL,EIGGEN,AMPLIT,LENMOD,
     1             EPSEIG,EPSFXL,EPSFIX,EPSPGL,NSEG,ISTIF,B,B2,H,W,W2,
     1             DNEUTX, DNEUTY,RESPRS,EPSPRS,EAVEP,-P,FNXPL0,FNYPL0,
     1             IABP,IWIDE,ECC,IBOUND,IBPRE,PRELEN,
C BEG OCT 1998
     1             EPSLOD,EPSLD0,ETHERM,CX,CY,THSMRX,THSMRY,IABT,
C BEG FEB 2005
     1             EPPB,EPSPB,EPSBPB,RESBGL,EPSBGL,AXIAL)
C END FEB 2005
C END OCT 1998
      ENDIF
C
      IF (IMOD.EQ.0.AND.IFX.GT.0.AND.JJJ.EQ.0) THEN
C BEG NOV 2003
C        WBOUND(1)='SIMPLE SUPPORT'
         WBOUND(1)='BENDING THEORY'
C BEG AUG 1992
C        IF (IBPRE.EQ.2) WBOUND(1) = 'INFINITLY LONG'
         IF (IBPRE.EQ.2) WBOUND(1) = 'MEMBRANETHEORY'
C END AUG 1992
C        IF (IBPRE.EQ.1) WBOUND(1) = 'CLAMPED       '
         IF (IBPRE.EQ.1) WBOUND(1) = 'BENDING THEORY'
C END NOV 2003
         WBOUND(2)='SIMPLE SUPPORT'
C BEG  1 MAY 1989
         IF (IBOUND.EQ.1) WBOUND(2) = 'CLAMPED       '
C BEG APRIL 1990
         WRITE(IFILE,1702) WBOUND(1),WBOUND(2),AMPLT2,AMPLIT
 1702    FORMAT(/' BOUNDARY CONDITIONS AND BOWING AMPLITUDE FACTORS:'/
     1 '   AXIAL BOUNDARY CONDITIONS FOR PREBUCKLING PHASE    =',A14/
     1 '   AXIAL BOUNDARY CONDITIONS FOR BIFURCATION BUCKLING =',A14/
C BEG OCT 1996
     1 '   AMPLITUDE FACTOR FOR BOWING DUE TO PRESSURE, THERMAL'/
     1 '   THRU-THICKNESS GRADIENT, EDGE MOMENTS,       AMPLT2=',
     1     1P,E12.4/
     1 '   AMPLITUDE FACTOR FOR DEFORMATION FROM GLOBAL IMPERFECTION'/
     1 '                                                AMPLIT='
C END OCT 1996
     1     1P,E12.4)
C END APRIL 1990
C
         IF (IWIDE.EQ.1.AND.ISTIF(2).EQ.0) WRITE(IFILE,1704)
 1704    FORMAT(
     1 ' THE PRELIMINARY GENERAL INSTABILITY LOAD IS COMPUTED FROM A'/
     1 ' MODEL IN WHICH THE PANEL IS ASSUMED TO BE FLAT. ITS DIMENSION'/
     1 ' PARALLEL TO THE SCREEN IS 10 TIMES ITS DIMENSION NORMAL TO'/
     1 ' THE SCREEN.'/)
C
C BEG 26 JAN 1989
C
C        IF (ISTIF(1).EQ.0) THEN
C           WRITE(IFILE,1706)
C1706       FORMAT(
C    1    ' THE CONSTITUTIVE C(i,j) MATRIX WITH FULL SKIN STIFFNESS'/
C    1    ' IS USED BECAUSE THERE ARE NO AXIAL STIFFENERS.'/)
C           GO TO 1720
C        ENDIF
C
C        IF (FSLOC.GE.0.95.AND.IWIDE.EQ.1) THEN
C           WRITE(IFILE,1708)
C1708       FORMAT(
C    1    ' THE CONSTITUTIVE C(i,j) MATRIX WITH FULL SKIN STIFFNESS'/
C    1    ' IS USED BECAUSE:'/
C    1    '   1. LOCAL BUCKLING OF THE SKIN IS NOT PERMITTED,'/
C    1 '   2. THE WIDE-COLUMN BUCKLING MODEL CONSTRAINS THE DESIGN.'/)
C           GO TO 1720
C        ENDIF
         IF (FSLOC.LT.0.95) THEN
            WRITE(IFILE,1710)
 1710       FORMAT(
     1    ' THE CONSTITUTIVE C(i,j) MATRIX WITH REDUCED SKIN STIFFNESS'/
     1    ' IS USED BECAUSE  LOCAL BUCKLING OF THE SKIN IS PERMITTED.'/)
            GO TO 1720
         ENDIF
C        IF (IWIDE.EQ.0) THEN
C           WRITE(IFILE,1712)
C1712       FORMAT(
C    1    ' THE CONSTITUTIVE C(i,j) MATRIX WITH REDUCED SKIN STIFFNESS'/
C    1    ' IS USED BECAUSE WIDE-COLUMN BUCKLING DOES NOT CONSTRAIN'/
C    1    ' THE DESIGN.'/)
C        ENDIF
         IF (FSLOC.GE.0.95) WRITE(IFILE,1708)
 1708       FORMAT(
     1    ' THE CONSTITUTIVE C(i,j) MATRIX WITH FULL SKIN STIFFNESS'/
     1    ' (ACCOUNTING FOR THERMAL EFFECTS, IF ANY) IS USED.'/)
C END 26 JAN 1989
C
 1720    CONTINUE
      ENDIF
C
C  SUPERPOSE RESULTANTS FROM LOADS AND FROM THERMAL CURE...
C
C BEG OCT 1998
      FMULT = 1.0
      IF (PEDG) FMULT = 0.0
      DO 200 I = 1,3
      DO 200 J = 1,5
      DO 200 K = 1,2
      EPSTOT(I,J,K) = EPSEIG(I,J,K) + EPSFXL(I,J,K) + EPSFIX(I,J,K)
     1               +EPSPGL(I,J,K) + EPSBGL(I,J,K) + EPSPRS(I,J,K)
      RESULT(I,J,K) = RESEIG(I,J,K) + RESFXL(I,J,K) + RESFIX(I,J,K)
     1               +RESPGL(I,J,K) + RESBGL(I,J,K) + RESPRS(I,J,K)
C     WRITE(8,*)' IN FORCES: I,J,K,RESULT(I,J,K) =',I,J,K,RESULT(I,J,K)
      RESTOT(I,J,K) =                 RESFXL(I,J,K) + RESFIX(I,J,K)
     1         +FMULT*RESPGL(I,J,K) + RESBGL(I,J,K) + RESPRS(I,J,K)
C        WRITE(8,'(A,/,1P,3I2,6E10.2)')
C    1 ' in FORCES: I,J,K,RESTOT,RESFXL,RESFIX,RESPGL,RESBGL,RESPRS=',
C    1              I,J,K,RESTOT(I,J,K),RESFXL(I,J,K),RESFIX(I,J,K),
C    1                    RESPGL(I,J,K),RESBGL(I,J,K),RESPRS(I,J,K)
  200 CONTINUE
      RWBTOT(1) =                     RWBFXL(1)     + RWBFIX(1)
     1               +FMULT*RWBPGL(1) + RWBBGL(1)
      RWBTOT(2) =                     RWBFXL(2)     + RWBFIX(2)
     1               +FMULT*RWBPGL(2) + RWBBGL(2)
C
      DO 201 I = 1,2
      DO 201 J = 1,4
      DO 201 K = 1,2
      WBSULT(I,J,K) = WBEIG(I,J,K) + WBFXL(I,J,K) + WBFIX(I,J,K)
     1               +WBPGL(I,J,K) +WBBGL(I,J,K)
      WBTOT(I,J,K) =                 WBFXL(I,J,K) + WBFIX(I,J,K)
     1         +FMULT*WBPGL(I,J,K) +WBBGL(I,J,K)
  201 CONTINUE
C
      IF (ISOGRD.EQ.1) THEN
         DO 202 I = 1,3
         DO 202 J = 1,5
         DO 202 K = 1,3
         ESTOT(I,J,K) = ESEIG(I,J,K) + ESFXL(I,J,K) + ESFIX(I,J,K)
     1                 +ESPGL(I,J,K) + ESBGL(I,J,K) + ESPRS(I,J,K)
         RSULT(I,J,K) = RSEIG(I,J,K) + RSFXL(I,J,K) + RSFIX(I,J,K)
     1                 +RSPGL(I,J,K) + RSBGL(I,J,K) + RSPRS(I,J,K)
         RSTOT(I,J,K) =                RSFXL(I,J,K) + RSFIX(I,J,K)
     1           +FMULT*RSPGL(I,J,K) + RSBGL(I,J,K) + RSPRS(I,J,K)
  202    CONTINUE
C
         DO 203 I = 1,3
            RWTOT(I) =              RWFXL(I)     + RWFIX(I)
     1                  +FMULT*RWPGL(I) + RWBGL(I)
  203    CONTINUE
      ENDIF
C
C     RESTOT(3,IWEB,1) = RESTOT(3,IWEB,1) - SHEARX
C     RESTOT(3,IWEB,2) = RESTOT(3,IWEB,2) - SHEARY
      EXAVE = EPSTOT(1,1,1) - EPSFIX(1,1,1)
C
C
      IF (IABP.EQ.1) THEN
        DO 210 I = 1,3
        DO 210 J = 1,5
        DO 210 K = 1,2
         EPSEIG(I,J,K) = EPSEIG(I,J,K)
     1               +EPSPGL(I,J,K) + EPSPRS(I,J,K)
         RESEIG(I,J,K) = RESEIG(I,J,K)
     1               +RESPGL(I,J,K) + RESPRS(I,J,K)
         RESTOT(I,J,K) = RESTOT(I,J,K)
     1         -FMULT*RESPGL(I,J,K) - RESPRS(I,J,K)
  210   CONTINUE
        DO 220 K = 1,2
         RWBEIG(K) = RWBEIG(K) + RWBPGL(K)
         RWBTOT(K) = RWBTOT(K) - FMULT*RWBPGL(K)
  220   CONTINUE
C
        DO 221 I = 1,2
        DO 221 J = 1,4
        DO 221 K = 1,2
         WBEIG(I,J,K) = WBEIG(I,J,K) +WBPGL(I,J,K)
         WBTOT(I,J,K) = WBTOT(I,J,K) -FMULT*WBPGL(I,J,K)
  221   CONTINUE
        IF (ISOGRD.EQ.1) THEN
           DO 222 I = 1,3
           DO 222 J = 1,5
           DO 222 K = 1,3
            ESEIG(I,J,K) = ESEIG(I,J,K)
     1                  +ESPGL(I,J,K) + ESPRS(I,J,K)
            RSEIG(I,J,K) = RSEIG(I,J,K)
     1                  +RSPGL(I,J,K) + RSPRS(I,J,K)
            RSTOT(I,J,K) = RSTOT(I,J,K)
     1                  -FMULT*RSPGL(I,J,K) - RSPRS(I,J,K)
  222      CONTINUE
           DO 223 K = 1,3
            RWEIG(K) = RWEIG(K) + RWPGL(K)
            RWTOT(K) = RWTOT(K) - FMULT*RWPGL(K)
  223      CONTINUE
        ENDIF
      ENDIF
C END OCT 1998
C
      FIABP = 1 - IABP
      DO 300 I = 1,6
C BEG OCT 1998
      EPSLDF(I) = EPSLD0(I) +FIABP*(EAVEP(I) + EAVEPL(I))
     1                            + EAVEPB(I)
      EPSLOD(I) = EPSLOD(I) +EPSLD0(I) +EAVEP(I) +EAVEPL(I)
     1                                 +EAVEPB(I)
C END OCT 1998
  300 CONTINUE
C
C     EPSLOD(4) = KX2L + KX2L0 + KX2P
C     EPSLOD(5) = KY3L + KY3L0 + KY3P
C     EPSLDF(4) =        KX2L0 + KX2P
C     EPSLDF(1) =        EX2L0 + EX2P
C
C BEG JULY 1989
      IF (IABT.EQ.1) THEN
C   SHIFT THERMAL LOADS INTO LOAD SET A (EIGENVALUE PARAMETERS)
         DO 310 I = 1,3
         DO 310 J = 1,5
         DO 310 K = 1,2
            EPSEIG(I,J,K) = EPSEIG(I,J,K) + EPSFIX(I,J,K)
            RESEIG(I,J,K) = RESEIG(I,J,K) + RESFIX(I,J,K)
            RESTOT(I,J,K) = RESTOT(I,J,K) - RESFIX(I,J,K)
  310    CONTINUE
C
         DO 320 K = 1,2
            RWBEIG(K) = RWBEIG(K) + RWBFIX(K)
            RWBTOT(K) = RWBTOT(K) - RWBFIX(K)
            RWBFIX(K) = 0.
  320    CONTINUE
C BEG AUG 1992
         DO 321 I = 1,2
         DO 321 J = 1,4
         DO 321 K = 1,2
            WBEIG(I,J,K) = WBEIG(I,J,K) + WBFIX(I,J,K)
            WBTOT(I,J,K) = WBTOT(I,J,K) - WBFIX(I,J,K)
  321    CONTINUE
         IF (ISOGRD.EQ.1) THEN
            DO 322 I = 1,3
            DO 322 J = 1,5
            DO 322 K = 1,3
               ESEIG(I,J,K) = ESEIG(I,J,K) + ESFIX(I,J,K)
               RSEIG(I,J,K) = RSEIG(I,J,K) + RSFIX(I,J,K)
               RSTOT(I,J,K) = RSTOT(I,J,K) - RSFIX(I,J,K)
  322       CONTINUE
C
            DO 323 K = 1,3
               RWEIG(K) = RWEIG(K) + RWFIX(K)
               RWTOT(K) = RWTOT(K) - RWFIX(K)
               RWFIX(K) = 0.
  323       CONTINUE
         ENDIF
C END AUG 1992
C
         DO 330 K = 1,6
            EPSLOD(K) = EPSLOD(K) + ETHERM(K)
  330    CONTINUE
      ENDIF
C END JULY 1989
C     WRITE(8,'(/,A,2I3,1P,E12.4)')' IABP,IABT,RESFIX(1,3,2)=',
C    1                               IABP,IABT,RESFIX(1,3,2)
C     DO 340 I = 1,3
C     DO 340 J = 1,3
C     DO 340 K = 1,2
C        WRITE(8,'(A,1P,3I2,3E10.2)')
C    1 ' in FORCES: I,J,K,RESTOT,RESPGL,RESPRS=',
C    1              I,J,K,RESTOT(I,J,K),RESPGL(I,J,K),RESPRS(I,J,K)
C 340 CONTINUE
C
      RETURN
      END
C
C
C
C=DECK      SHRBOW
      SUBROUTINE SHRBOW(IFILE,INDX,FMOMX,FMOMY,IMOD,JJJ)
C
C  PURPOSE IS TO CALCULATE MAXIMUM SHEAR RESULTANT IN THE STRINGER
C  WEB CAUSED BY OVERALL PANEL BOWING AND AXIAL LOAD ECCENTRICITY.
C  THIS SHEAR RESULTANT IS CALCULATED BASED ON THE ASSUMPTION THAT
C  THE MOMENT VARIES AS SIN(PI*X/AXIAL) AND THAT ALL OF THE TRANSVERSE
C  SHEAR IS CARRIED BY THE WEB
C
      COMMON/OUTP/NPRT
      COMMON/GEOM1/AXIAL,CIRC,R
      COMMON/GEOM3/ISTIF(2),NLAYER(4,2),NSEG(2),INTEXT(2)
      COMMON/SHRWEB/SHEARX,XMAX,SHEARY,YMAX
      COMMON/ALLCIJ/CX(6,6,5),CY(6,6,5),CS(6,6)
      COMMON/ZPARTS/ZPARTX(5),ZPARTY(5)
      COMMON/GEOM2/B(2),B2(2),H(2),WW(2),WW2(2)
C
      WXMAX = AXIAL**4/CS(4,4)
      WYMAX =  CIRC**4/CS(5,5)
      FMULTX= 1.0
      IF (WXMAX.GT.WYMAX) FMULTX = WYMAX/WXMAX
      FMULTY = 1.0
      IF (WYMAX.GT.WXMAX) FMULTY = WXMAX/WYMAX
C
      IF (INDX.EQ.2) GO TO 20
C
C  TO THE STRINGER WEB...   
C
C  SHEAR IN STRINGER WEB AS CALCULATED FROM SIMPLE BEAM THEORY, ASSUMING THAT
C  THE SHEAR IS UNIFORM IN THE DIRECTION NORMAL TO THE STRINGER AXIS
C  THAT ALL THE SHEAR IS CARRIED BY THE STRINGER WEBS,
C  AND THAT THE MOMENT VARIES AS SIN(PI*X/AXIAL) AND THAT THE TRANSVERSE
C  SHEAR FORCE Q = DM/DX, WHERE M = [FORCE*(WBOW-ECC)]SIN(PI*X/AXIAL)
C
      PI = 3.1415927
      SHBOWX = FMULTX*B(1)*PI*FMOMX/(H(1)*AXIAL)
C BEG JULY 1989
      IF (ISTIF(1).EQ.4.OR.ISTIF(1).EQ.5) SHBOWX = 0.5*SHBOWX
C END JULY 1989
C
C  THE SHEAR IS PLUS AT ONE END OF THE PANEL AND MINUS AT THE OTHER.
C  DECIDE WHICH IS THE WORST FROM THE POINT OF VIEW OF BUCKLING.
C
      XMAXB = 0.
C BEG JULY 1989
      IWEB = 3
      IF (ISTIF(1).EQ.5) IWEB = 2
      IF (CX(4,6,IWEB).GE.0.) THEN
C END JULY 1989
         IF (SHBOWX.GE.0.) GO TO 5
         XMAXB = AXIAL - XMAXB
         SHBOWX = ABS(SHBOWX)
         GO TO 5
      ELSE
         IF (SHBOWX.LE.0.) GO TO 5
         XMAXB = AXIAL - XMAXB
         SHBOWX = -ABS(SHBOWX)
      ENDIF
    5 CONTINUE
C
C ADD TO SHEAR CAUSED BY REACTION AT BOUNDARIES TO NORMAL PRESSURE...
C
      DIFF = ABS(XMAX - XMAXB)/AXIAL
      IF (DIFF.LT.0.01) THEN
         SHEARX = SHEARX + SHBOWX
         GO TO 100
      ELSE
         XMAX = XMAXB
         IF (SHEARX.EQ.0.0) THEN
            SHEARX = SHBOWX
            GO TO 100
         ELSE
            SHRTOT = ABS(SHEARX) + ABS(SHBOWX)
            XMAXB = 0.
C BEG JULY 1989
            IF (CX(4,6,IWEB).GE.0.) THEN
C END JULY 1989
               IF (SHRTOT.GE.0.) GO TO 10
               XMAXB = AXIAL - XMAXB
               SHRTOT = ABS(SHRTOT)
               GO TO 10
            ELSE
               IF (SHRTOT.LE.0.) GO TO 10
               XMAXB = AXIAL - XMAXB
               SHRTOT = -ABS(SHRTOT)
            ENDIF
   10       CONTINUE
         ENDIF
         XMAX = XMAXB
      ENDIF
C
      GO TO 100
C
   20 CONTINUE
C
C  TO THE RING WEB...   
C
C  SHEAR IN RING WEB AS CALCULATED FROM SIMPLE BEAM THEORY, ASSUMING THAT
C  THE SHEAR IS UNIFORM IN THE DIRECTION NORMAL TO THE RING AXIS
C  THAT ALL THE SHEAR IS CARRIED BY THE RING WEBS,
C  AND THAT THE MOMENT VARIES AS SIN(PI*Y/CIRC) AND THAT THE TRANSVERSE
C  SHEAR FORCE Q = DM/DY, WHERE M = [FORCE*(WBOW-ECC)]SIN(PI*Y/CIRC)
C
C BEG OCT 1994
      PI = 3.1415927
C END OCT 1994
      SHBOWY = FMULTY*B(2)*PI*FMOMY/(H(2)*CIRC)
C BEG JULY 1989
      IF (ISTIF(2).EQ.4.OR.ISTIF(2).EQ.5) SHBOWY = 0.5*SHBOWY
C END JULY 1989
C
C  THE SHEAR IS PLUS AT ONE END OF THE PANEL AND MINUS AT THE OTHER.
C  DECIDE WHICH IS THE WORST FROM THE POINT OF VIEW OF BUCKLING.
C
      YMAXB = 0.
C BEG JULY 1989
      IWEB = 3
      IF (ISTIF(2).EQ.5) IWEB = 2
      IF (CY(4,6,IWEB).GE.0.) THEN
C END JULY 1989
         IF (SHBOWY.GE.0.) GO TO 25
         IF (INTEXT(2).EQ.0) YMAXB = CIRC - YMAXB
         SHBOWY = ABS(SHBOWY)
         GO TO 25
      ELSE
         IF (SHBOWY.LE.0.) GO TO 25
         IF (INTEXT(2).EQ.0) YMAXB = CIRC - YMAXB
         SHBOWY = -ABS(SHBOWY)
      ENDIF
   25 CONTINUE
C
C ADD TO SHEAR CAUSED BY REACTION AT BOUNDARIES TO NORMAL PRESSURE...
C
      DIFF = ABS(YMAX - YMAXB)/CIRC
      IF (DIFF.LT.0.01) THEN
         SHEARY = SHEARY + SHBOWY
         GO TO 100
      ELSE
         YMAX = YMAXB
         IF (SHEARY.EQ.0.0) THEN
            SHEARY = SHBOWY
            GO TO 100
         ELSE
            SHRTOT = ABS(SHEARY) + ABS(SHBOWY)
            YMAXB = 0.
C BEG JULY 1989
            IF (CY(4,6,IWEB).GE.0.) THEN
C END JULY 1989
               IF (SHRTOT.GE.0.) GO TO 30
               YMAXB = CIRC - YMAXB
               SHRTOT = ABS(SHRTOT)
               GO TO 30
            ELSE
               IF (SHRTOT.LE.0.) GO TO 30
               YMAXB = CIRC - YMAXB
               SHRTOT = -ABS(SHRTOT)
            ENDIF
   30       CONTINUE
         ENDIF
         YMAX = YMAXB
      ENDIF
C
  100 CONTINUE
      IF (INDX.EQ.1.AND.IMOD.EQ.0.AND.JJJ.EQ.0.AND.NPRT.GE.1) THEN
         WRITE(IFILE,110) SHBOWX, XMAXB, SHEARX, XMAX
  110    FORMAT(/' SHEAR RESULTANT IN WEB AT STRINGER ENDS...'/
     1' Shear resultant due to axial load/bowing effect=   ',1P,E12.4/
     1' Axial coordinate corresponding to lowest buckling= ',1P,E12.4/
     1' Total shear resultant from pressure + bowing     = ',1P,E12.4/
     1' Axial coordinate corresponding to pressure part  = ',1P,E12.4)
       ENDIF
      IF (INDX.EQ.2.AND.IMOD.EQ.0.AND.JJJ.EQ.0.AND.NPRT.GE.1) THEN
         WRITE(IFILE,120) SHBOWY, YMAXB, SHEARY, YMAX
  120    FORMAT(/' SHEAR RESULTANT IN WEB AT RING ENDS...'/
     1' Shear resultant due to circ. load/bowing effect=   ',1P,E12.4/
     1' Axial coordinate corresponding to lowest buckling= ',1P,E12.4/
     1' Total shear resultant from pressure + bowing     = ',1P,E12.4/
     1' Axial coordinate corresponding to pressure part  = ',1P,E12.4)
       ENDIF
C
      RETURN
      END
C
C
C
C=DECK      STRDIS
      SUBROUTINE STRDIS(ICURE1,ICURE2,FTHERM,F,G,B,B2,W2,EKAVE,CX,CY,
     1           THERMX,THERMY,EP121,EP122,EP123,FNXY,
C BEG JULY 1989
     1           EPSX3,EPSY2,EPSX1,EPSY1,KAPX3,KAPY2,KAPX1,KAPY1,ISTIF)
C END JULY 1989
C
C  PURPOSE IS TO OBTAIN REFERENCE SURFACE STRAINS AND CHANGES IN
C  CURVATURE IN VARIOUS PARTS OF THE STIFFENED PANEL.
C
C BEG MAY 1997
      COMMON/IZSTIX/IZSTIF(2)
C END MAY 1997
      COMMON/GEOM6/IFAY(2),IMISCL(28)
C BEG JULY 1989
      DIMENSION F(5,2),G(5,2),B(*),B2(*),W2(*),EKAVE(*),ISTIF(*)
C END JULY 1989
      DIMENSION CX(6,6,5),CY(6,6,5),THERMX(6,5),THERMY(6,5)
      REAL KAPX3,KAPY2,KAPX1,KAPY1
C
      B11 = (B(1) - B2(1))/B(1)
      B12 = B2(1)/B(1)
      B21 = B2(2)/B(2)
      B22 = (B(2) - B2(2))/B(2)
C BEG MAY 1997
      IF (IZSTIF(1).EQ.1) THEN
         B11 = 1.0
         B12 = 0.0
      ENDIF
      IF (IZSTIF(2).EQ.1) THEN
         B21 = 0.0
         B22 = 1.0
      ENDIF
C END MAY 1997
C BEG NOV 1995
      IF (ISTIF(1).EQ.5) THEN
         B11 = 1.0
         B12 = 0.
      ENDIF
      IF (ISTIF(2).EQ.5) THEN
         B22 = 1.0
         B21 = 0.
      ENDIF
C END NOV 1995
C
C  NOTE:  IFAY(i) = 1 MEANS THAT:
C          1. THE STIFFENER IS A HAT.
C          2. THE BASE WIDTH B2(i) IS GREATER THAN THE HAT WIDTH W2(i)
C          3. THE WALL UNDER THE HAT IS THE SAME AS THAT IN SEGMENT 1.
C
      IF (IFAY(1).EQ.1) THEN
         B11 = (B(1) - (B2(1)-W2(1)))/B(1)
         B12 = (B2(1) - W2(1))/B(1)
      ENDIF
C
      IF (IFAY(2).EQ.1) THEN
         B22 = (B(2) - (B2(2)-W2(2)))/B(2)
         B21 = (B2(2) - W2(2))/B(2)
      ENDIF
C
      IF (ICURE1.EQ.0) THEN
         B11 = 1.
         B12 = 0.
      ENDIF
      IF (ICURE2.EQ.0) THEN
         B22 = 1.
         B21 = 0.
      ENDIF
C
      EPSX3 = FTHERM*F(1,1) + F(2,1)*EKAVE(1) + F(3,1)*EKAVE(2)
     1                      + F(4,1)*EKAVE(4) + F(5,1)*EKAVE(5)
C
      KAPX3 = FTHERM*G(1,1) + G(2,1)*EKAVE(1) + G(3,1)*EKAVE(2)
     1                      + G(4,1)*EKAVE(4) + G(5,1)*EKAVE(5)
C
      EPSY2 = FTHERM*F(1,2) + F(2,2)*EKAVE(1) + F(3,2)*EKAVE(2)
     1                      + F(4,2)*EKAVE(4) + F(5,2)*EKAVE(5)
C
      KAPY2 = FTHERM*G(1,2) + G(2,2)*EKAVE(1) + G(3,2)*EKAVE(2)
     1                      + G(4,2)*EKAVE(4) + G(5,2)*EKAVE(5)
C
      EPSX1 = (EKAVE(1) - B21*EPSX3)/B22
      EPSY1 = (EKAVE(2) - B12*EPSY2)/B11
      KAPX1 = (EKAVE(4) - B21*KAPX3)/B22
      KAPY1 = (EKAVE(5) - B12*KAPY2)/B11
C BEG MAY 1997
      IF (IZSTIF(1).EQ.1) THEN
         KAPY2 = 0.0
         EPSY2 = -(CX(1,2,2)*EPSX1 +CX(2,4,2)*KAPX1 
     1                                +FTHERM*THERMX(2,2))/CX(2,2,2)
      ENDIF
      IF (IZSTIF(2).EQ.1) THEN
         KAPX3 = 0.0
         EPSX3 = -(CY(1,2,2)*EPSY1 +CY(2,4,2)*KAPY1
     1                                +FTHERM*THERMY(2,2))/CY(2,2,2)
      ENDIF
C END MAY 1997
C
C
C  JUNE 27, 1987 MOD: DERIVE THE SHEAR STRAINS IN THE THIN (EP121) AND
C  THICK (EP122 AND EP123) PARTS OF THE PANEL SKIN...
C
      EP121 = (FNXY +FTHERM*THERMX(3,1)
     1       -CX(3,1,1)*EPSX1 -CX(3,2,1)*EPSY1 -CX(3,4,1)*KAPX1
     1       -CX(3,5,1)*KAPY1 -CX(3,6,1)*EKAVE(6) )/CX(3,3,1)
C BEG MAY 1997
      EP122 = 0.0
      EP123 = 0.0
C END MAY 1997
C BEG JULY 1989
      IF (ISTIF(1).EQ.5) THEN
         EP121 = EKAVE(3)
         EP122 = EP121
         EP123 = -EP121
      ENDIF
C
C BEG MAY 1997
      IF (CX(3,3,2).GT.0.0.AND.ISTIF(1).NE.5.AND.IZSTIF(1).EQ.0)
C END MAY 1997
     1  EP122 = (FNXY +FTHERM*THERMX(3,2)
     1       -CX(3,1,2)*EPSX1 -CX(3,2,2)*EPSY2 -CX(3,4,2)*KAPX1
     1       -CX(3,5,2)*KAPY2 -CX(3,6,2)*EKAVE(6) )/CX(3,3,2)
C
C BEG MAY 1997
      IF (CY(3,3,2).GT.0.0.AND.ISTIF(2).NE.5.AND.ISTIF(2).NE.0
     1                                      .AND.IZSTIF(2).EQ.0)
C END MAY 1997
     1  EP123 =-(FNXY +FTHERM*THERMY(3,2)
     1       -CY(3,1,2)*EPSY1 -CY(3,2,2)*EPSX3 -CY(3,4,2)*KAPY1
     1       -CY(3,5,2)*KAPX3 -CY(3,6,2)*EKAVE(6) )/CY(3,3,2)
C
      IF (ISTIF(1).EQ.5) THEN
         EPSY2 = EPSY1
         KAPY2 = KAPY1
      ENDIF
      IF (ISTIF(2).EQ.5) THEN
         EPSX3 = EPSX1
         KAPX3 = KAPX1
      ENDIF
C
C END JULY 1989
C
C  FOLLOWING MOD. MADE 6 AUG. 1986. THE AIM IS TO MODIFY EPSY2 AND EPSX3
C  SO THAT THE HOOP RESULTANT IS THE SAME IN THE SKIN AS IT IS IN THE
C  STRINGER BASE AND THE AXIAL RESULTANT IS THE SAME IN THE SKIN AS
C  THE TRANSVERSE STRAIN IN THE RING BASE.
C
C        FNYSKN = CX(1,2,1)*EPSX1 +CX(2,2,1)*EPSY1
C    1     +CX(2,4,1)*KAPX1 +CX(2,5,1)*KAPY1 -FTHERM*THERMX(2,1)
C        EPSY2 = (FNYSKN -CX(1,2,2)*EPSX1 -CX(2,4,2)*KAPX1
C    1           -CX(2,5,2)*KAPY2 +FTHERM*THERMX(2,2))/CX(2,2,2)
C        FNXSKN = CX(1,1,1)*EPSX1 +CX(1,2,1)*EPSY1
C    1     +CX(1,4,1)*KAPX1 +CX(1,5,1)*KAPY1 -FTHERM*THERMX(1,1)
C        EPSX3 = (FNXSKN -CY(1,2,2)*EPSY1 -CY(2,4,2)*KAPY1
C    1           -CY(2,5,2)*KAPX3 +FTHERM*THERMY(2,2))/CY(2,2,2)
C
C     ENDIF
C
C  END OF 6 AUG. 86 MOD.
C
C     WRITE(8,*) ' EKAVE(I),I=1,6 =',(EKAVE(I),I=1,6)
C     WRITE(8,*) ' F(I,1),I=1,5=',(F(I,1),I=1,5)
C     WRITE(8,*) ' F(I,2),I=1,5=',(F(I,2),I=1,5)
C     WRITE(8,*) ' G(I,1),I=1,5=',(G(I,1),I=1,5)
C     WRITE(8,*) ' G(I,2),I=1,5=',(G(I,2),I=1,5)
C     WRITE(8,*) ' EPSX3,EPSY2,EPSX1,EPSY1=',EPSX3,EPSY2,EPSX1,EPSY1
C     WRITE(8,*) ' KAPX3,KAPY2,KAPX1,KAPY1=',KAPX3,KAPY2,KAPX1,KAPY1
C
      RETURN
      END
C
C
C
C=DECK      EPSSKN
C BEG 26 JAN 1989
      SUBROUTINE EPSSKN(ICURE1,ICURE2,ETHRMX,ETHRMY,EX2,EY3,EX3,EY2,
     1                  NXY,CX,CY,EP121,EP122,EP123,EPS,ETSMRX,ETSMRY,
     1                  ISTIF)
C
C  PURPOSE IS TO FILL EPS(I,J,K) WITH STRAINS FOR PANEL SKIN,
C  THIN AND THICK PARTS.
C
      DIMENSION CX(6,6,5),CY(6,6,5),EPS(3,5,2),ETHRMX(6,5),ETHRMY(6,5)
      DIMENSION ETSMRX(6,5),ETSMRY(6,5),ISTIF(2)
      REAL NXY
C
      EPS(1,1,1) = EX2   + ETHRMX(1,1) - ETSMRX(1,1)
      EPS(2,1,1) = EY3   + ETHRMX(2,1) - ETSMRX(2,1)
      EPS(3,1,1) = EP121 + ETHRMX(3,1) - ETSMRX(3,1)
C
C     WRITE(8,*) '  EX2,ETHRMX(1,1),ETSMRX(1,1),EPS(1,1,1)=',
C    1              EX2,ETHRMX(1,1),ETSMRX(1,1),EPS(1,1,1)
C
C BEG JULY 1989
      IF (ISTIF(1).NE.0.AND.ISTIF(1).NE.5) THEN
C END JULY 1989
         EPS(1,2,1) = EX2   + ETHRMX(1,2) - ETSMRX(1,2)
         EPS(2,2,1) = EY2   + ETHRMX(2,2) - ETSMRX(2,2)
         EPS(3,2,1) = EP122 + ETHRMX(3,2) - ETSMRX(3,2)
      ENDIF
C
      IF (ISTIF(2).NE.0) THEN
         EPS(1,1,2) = EY3     + ETHRMY(1,1) - ETSMRY(1,1)
         EPS(2,1,2) = EX2     + ETHRMY(2,1) - ETSMRY(2,1)
         EPS(3,1,2) = -EP121  - ETHRMY(3,1) + ETSMRY(3,1)
C
C BEG JULY 1989
         IF (ISTIF(2).NE.5) THEN
            EPS(1,2,2) = EY3     + ETHRMY(1,2) - ETSMRY(1,2)
            EPS(2,2,2) = EX3     + ETHRMY(2,2) - ETSMRY(2,2)
            EPS(3,2,2) = EP123   + ETHRMY(3,2) - ETSMRY(3,2)
         ENDIF
C END JULY 1989
      ENDIF
C
C END 26 JAN 1989
C
      RETURN
      END
C
C
C
C=DECK      RES
      SUBROUTINE RES(J,K,C,THERM,EPS,FMULT,NXY,RESULT)
C
C  PURPOSE IS TO CALCULATE RESULTANTS FROM C(I,J), THERM, AND EPS.
C
      DIMENSION C(6,6),THERM(*),EPS(*),RESULT(3,5,2)
      REAL NXY
C
      DO 10 I = 1,3
      RESULT(I,J,K) = 0.
      DO  9 L = 1,6
      RESULT(I,J,K) = RESULT(I,J,K) + C(I,L)*EPS(L)
    9 CONTINUE
      RESULT(I,J,K) = RESULT(I,J,K) - FMULT*THERM(I)
   10 CONTINUE
C
C     RESULT(3,J,K) = NXY
C
      IF (J.EQ.1) THEN
         RESULT(1,1,2) = RESULT(2,1,1)
         RESULT(2,1,2) = RESULT(1,1,1)
         RESULT(3,1,2) = - RESULT(3,1,1)
      ENDIF
C
      RETURN
      END
C
C
C
C BEG MARCH 1990
C=DECK      RES2
      SUBROUTINE RES2(IPART,C,THERM,EPS,FMULT,RESULT)
C
C  PURPOSE IS TO CALCULATE RESULTANTS FROM C(I,J), THERM, AND EPS.
C
      DIMENSION C(6,6),THERM(*),EPS(*),RESULT(6,3)
C
      DO 10 I = 1,6
      RESULT(I,IPART) = 0.
      DO  9 L = 1,6
      RESULT(I,IPART) = RESULT(I,IPART) + C(I,L)*EPS(L)
    9 CONTINUE
      RESULT(I,IPART) = RESULT(I,IPART) - FMULT*THERM(I)
   10 CONTINUE
      RETURN
      END
C END MARCH 1990
C
C
C
C=DECK      WEBFLN
C BEG AUG 1992
      SUBROUTINE WEBFLN(FMULT,EPS,KAP,ETHRM,ZPART,THERM,
     1            C,ISTIF,NSEG,B,B2,H,W,W2,RESWEB,RESFLN,FSTIF,EPSSTF,
     1            RESMIN,THSMR,ETSMR,ET3,TT3,TBASE,
     1            KAP2,KAP12,PRESS,FPRESS,WB,
     1            C3,TSMR,NNODES,TEMPM,TEMPP,IMTEMP)
C END AUG 1992
C
C  PURPOSE IS TO CALCULATE RESULTANTS AND TOTAL LOADS CARRIED BY
C  THE WEB AND FLANGE OF THE STIFFENER.
C
      DIMENSION ZPART(*),THERM(6,5),C(6,6,5),EPSSTF(3,5)
C BEG AUG 1992
      DIMENSION ETHRM(6,5),THSMR(6,5),ETSMR(6,5),WB(2)
      DIMENSION C3(6,6,11),TSMR(6,11)
C END AUG 1992
      DIMENSION RESWEB(3),RESFLN(3)
      REAL KAP,KAP12,KAP2
C
      DO 10 I = 1,3
         RESWEB(I) = 0.
         RESFLN(I) = 0.
   10 CONTINUE
      RESMIN = 0.
      FSTIF  = 0.
      ET4 = 0.
      TT4 = 0.
      S   = H
C
      IF (ISTIF.EQ.4) S = SQRT(H**2 + .25*(W2-W)**2)
C BEG NOV 1995
      IF (ISTIF.EQ.5) S = SQRT(H**2 + .25*(B-2.*B2)**2)
C END NOV 1995
      IWEB = 3
      IF (ISTIF.EQ.5) IWEB = 2
      IWEBP = IWEB + 1
C
      IF (NSEG.GT.2) THEN
C        ET3 = C(1,1,IWEB) - C(1,2,IWEB)**2/C(2,2,IWEB)
C        TT3 = THSMR(1,IWEB) -C(1,2,IWEB)*THSMR(2,IWEB)/C(2,2,IWEB)
         IF (NSEG.GT.3) THEN
            ET4 = C(1,1,4) - C(1,2,4)**2/C(2,2,4)
            TT4 = THSMR(1,4) -C(1,2,4)*THSMR(2,4)/C(2,2,4)
         ENDIF
C
         WFL = W
         TBASE2 = 0.5*TBASE
         FPRESS = 0.
         EPS1P = 0.
         EPS2P1 = 0.
         EPS2P2 = 0.
         EPS2P3 = 0.
         IF (ISTIF.EQ.5) THEN
            ET4 = C(1,1,3)
            TT4 = THSMR(1,3)
            WFL = B
            TBASE2 = 0.
            FPRESS = -ABS(PRESS*B*S/(2.*H))
C BEG MAY 1990
C           IF (PRESS.NE.0.) THEN
C              C1S1 = C(1,1,1) - C(1,2,1)**2/C(2,2,1)
C              C1S2 = C(1,1,2) - C(1,2,2)**2/C(2,2,2)
C              C1S3 = C(1,1,3) - C(1,2,3)**2/C(2,2,3)
C              CSUM = C1S1 + C1S2 + C1S3
C              EPS1P= -C(1,2,2)*FPRESS/(C(2,2,2)*CSUM)
C              EPS2P1 = -C(1,2,1)*EPS1P/C(2,2,1)
C              EPS2P2 = (FPRESS - C(1,2,2)*EPS1P)/C(2,2,2)
C              EPS2P3 = -C(1,2,3)*EPS1P/C(2,2,3)
C           ENDIF
C END MAY 1990
         ENDIF
C
         EPSSTF(1,IWEB) = EPS - ZPART(IWEB)*KAP 
     1                  + ETHRM(1,IWEB) - ETSMR(1,IWEB)
         EPSSTF(2,IWEB) =(FMULT*THERM(2,IWEB) 
     1              -C(1,2,IWEB)*EPSSTF(1,IWEB))/C(2,2,IWEB) + EPS2P2
         EPSSTF(1,IWEB) = EPSSTF(1,IWEB) + EPS1P
         EPSSTF(3,IWEB) = 0.
         IF (ISTIF.EQ.5) EPSSTF(3,IWEB) =
     1                           (EPSSTF(3,1)+ZPART(2)*KAP12)*0.5*B/S
         IF (NSEG.GT.3) THEN
            EPSSTF(1,4) = EPS - ZPART(4)*KAP + ETHRM(1,4) - ETSMR(1,4)
            EPSSTF(2,4)=(FMULT*THERM(2,4)-C(1,2,4)*EPSSTF(1,4))/C(2,2,4)
            EPSSTF(3,4) = 0.
         ENDIF
C
         IF (ISTIF.EQ.5) THEN
            EPSSTF(1,3) = EPS - ZPART(3)*KAP + ETHRM(1,3) - ETSMR(1,3)
     1                   + EPS1P
            EPSSTF(2,3)= EPSSTF(2,1) - ZPART(3)*KAP2
     1                   + ETHRM(2,3) - ETSMR(2,3) + EPS2P2
            EPSSTF(3,3) = EPSSTF(3,1) +ZPART(3)*KAP12
         ENDIF
         RESWEB(1) = ET3*(EPS - ZPART(IWEB)*KAP) - FMULT*TT3
         RESFLN(1) = ET4*(EPS - ZPART(IWEBP)*KAP) - FMULT*TT4
         IF (ISTIF.EQ.5) THEN
            RESWEB(2) = FPRESS
            RESWEB(3) = C(1,3,2)*EPSSTF(1,2) + C(2,3,2)*EPSSTF(2,2)
     1                 +C(3,3,2)*EPSSTF(3,2)
            RESFLN(1) = C(1,1,3)*EPSSTF(1,3) + C(1,2,3)*EPSSTF(2,3)
     1                 +C(1,3,3)*EPSSTF(3,3) - FMULT*THSMR(1,3)
            RESFLN(2) = C(1,2,3)*EPSSTF(1,3) + C(2,2,3)*EPSSTF(2,3)
     1                 +C(2,3,3)*EPSSTF(3,3) - FMULT*THSMR(2,3)
            RESFLN(3) = C(1,3,3)*EPSSTF(1,3) + C(2,3,3)*EPSSTF(2,3)
     1                 +C(3,3,3)*EPSSTF(3,3)
         ENDIF
C
         FSTIF = (RESWEB(1)*2.*S + RESFLN(1)*WFL)/B
C
C  CALCULATE AXIAL COMPRESSION AT DIFFERENT POINTS IN THE WEB.
C  THIS VALUE WILL BE USED FOR CRIPPLING OF THE WEB BY ITSELF AND
C  IN FORMULAS FOR BUCKLING WITH STIFFENER ROLLING....
C
         ZDIST1 = TBASE2 + 0.4*H
C BEG AUG 1992
         IF (ISTIF.EQ.3) ZDIST1 = TBASE2 + 0.70*H
C END AUG 1992
         IF (ISTIF.EQ.5) ZDIST1 = TBASE2 + 0.25*H
         ZDIST1 = MIN(ABS(ZPART(IWEB)),ZDIST1)
         ZDIST2 = TBASE2 + 0.7*H
         ZDIST2 = MAX(ABS(ZPART(IWEB)),ZDIST2)
         ZMULT  = 1.
         IF (ZPART(IWEB).LT.0.) ZMULT = -1.
         RES1  = ET3*(EPS -ZMULT*ZDIST1*KAP) -FMULT*TT3
         RES2  = ET3*(EPS -ZMULT*ZDIST2*KAP) -FMULT*TT3
         RESMIN= MIN(RES1,RES2)
         RESMIN= MIN(RESMIN,RESWEB(1))
C BEG AUG 1992
         ZDIST1 = TBASE2
         ZDIST2 = TBASE2 + H
         WB(1) = ET3*(EPS -ZMULT*ZDIST1*KAP) -FMULT*TT3
         WB(2) = ET3*(EPS -ZMULT*ZDIST2*KAP) -FMULT*TT3
         IF (IMTEMP.EQ.1.AND.TEMPM.NE.TEMPP.AND.FMULT.NE.0) THEN
            TTROOT = TSMR(1,1) -C3(1,2,1)*TSMR(2,1)/C3(2,2,1)
            TTTIP  = TSMR(1,NNODES) 
     1                  -C3(1,2,NNODES)*TSMR(2,NNODES)/C3(2,2,NNODES)
            WB(1) = ET3*(EPS -ZMULT*ZDIST1*KAP) -FMULT*TTROOT
            WB(2) = ET3*(EPS -ZMULT*ZDIST2*KAP) -FMULT*TTTIP
         ENDIF
C END AUG 1992
      ENDIF
C
      RETURN
      END
C
C
C
C=DECK      ETOTAL
      SUBROUTINE ETOTAL(EPS,EPS0,ETH,ETOT)
C
C  PURPOSE IS TO DERIVE TOTAL STRAINS AND CHANGES IN CURVATURE FROM
C  BOTH THE APPLIED LOADS AND ALL THERMAL DEFORMATIONS..
C
      DIMENSION EPS(*),EPS0(*),ETH(*),ETOT(*)
C
      ETOT(1)= EPS(1) + EPS0(1) + ETH(1)
      ETOT(2)= EPS(2) + EPS0(2) + ETH(2)
      ETOT(3)= EPS(3) + EPS0(3) + ETH(3)
      ETOT(4)= EPS(4) + EPS0(4) + ETH(4)
      ETOT(5)= EPS(5) + EPS0(5) + ETH(5)
      ETOT(6)= EPS(6) + EPS0(6) + ETH(6)
C
      RETURN
      END
C
C
C
C=DECK      OUTNX
      SUBROUTINE OUTNX(IFILE,NX,NY,NXY,NX0,NY0,NXY0,EPSLOD,EPS,EPSB,
     1ETHERM,ETH,ETHB,EP0,EPS0,EPSB0,EPP,EPSP,EPSBP,FNXP0,FNYP0,
     1RESEIG,RESFXL,RESFIX,RESPGL,EIGGEN,
     1AMPLIT,LENMOD,EPSEIG,EPSFXL,EPSFIX,EPSPGL,
     1 NSEG,ISTIF,B,B2,H,W,W2,DNEUTX,DNEUTY,RESPRS,EPSPRS,EAVEP,P,
     1 FNXPL0,FNYPL0,IABP,IWIDE,ECC,IBOUND,IBPRE,PRELEN,
C BEG OCT 1998
     1 EPSLDP,EPSLD0,ETHRMP,CX,CY,THSMRX,THSMRY,IABT,
C BEG FEB 2005
     1 EPPB,EPSPB,EPSBPB,RESBGL,EPSBGL,AXIAL)
C END FEB 2005
C END OCT 1998
C
C
C PURPOSE IS TO PRINT OUT STUFF.
C
      DIMENSION EPSLDP(*),EPSLD0(*),ETHRMP(*)
      DIMENSION CX(6,6,5),CY(6,6,5),THSMRX(6,5),THSMRY(6,5)
      DIMENSION RESCHK(6,3),WORD4(3)
      CHARACTER*8 WORD4
C BEG SEPT 1990
      CHARACTER*12 WORDAB
C END SEPT 1990
      DIMENSION EPSLOD(*),EPS(*),EPSB(*),ETHERM(*),ETH(*),ETHB(*)
      DIMENSION EP0(6),EPS0(6),EPSB0(6),EPP(6),EPSP(6),EPSBP(6)
C BEG OCT 1998
      DIMENSION EPPB(6),EPSPB(6),EPSBPB(6),RESBGL(3,5,2),EPSBGL(3,5,2)
C END OCT 1998
      DIMENSION RESEIG(3,5,2),RESFXL(3,5,2),RESFIX(3,5,2)
      DIMENSION RESPGL(3,5,2),RESPRS(3,5,2),RESSUM(3,5,2)
      DIMENSION EPSEIG(3,5,2),EPSFXL(3,5,2),EPSFIX(3,5,2)
      DIMENSION EPSPGL(3,5,2),EPSPRS(3,5,2),EAVEP(6),EPSSUM(3,5,2)
      DIMENSION ETOT1(6),ETOT2(6),ETOT3(6),NEIG(3),NFIX(3),NTOT(3)
      DIMENSION NFXL(3)
      DIMENSION NSEG(*),ISTIF(*),B(*),B2(*),H(*),W(*),W2(*)
      DIMENSION NTAPPL(3)
C BEG AUG 1992
      COMMON/ISOGR/ISOGRD,ISOANG
      COMMON/LOADS6/RSEIG(3,5,3),RSFXL(3,5,3),RSPGL(3,5,3),RSFIX(3,5,3)
      COMMON/LOADS7/ESEIG(3,5,3),ESFXL(3,5,3),ESPGL(3,5,3),ESFIX(3,5,3)
      COMMON/LOADS8/RWEIG(3),RWFXL(3),RWPGL(3),RWFIX(3),RWTOT(3)
      COMMON/LOADS9/RSPRS(3,5,3),ESPRS(3,5,3),RSTOT(3,5,3),RSULT(3,5,3)
      COMMON/LODS10/ESTOT(3,5,3)
      COMMON/LODS11/WBEIG(2,4,2),WBTOT(2,4,2),WBSULT(2,4,2)
      COMMON/LODS12/WBFXL(2,4,2),WBPGL(2,4,2),WBFIX(2,4,2),WBPRS(2,4,2)
      CHARACTER*8 WRDISO
C END AUG 1992
      REAL NX,NY,NXY,LENMOD,NEIG,NFIX,NTOT,NTAPPL,NFXL
      REAL NX0,NY0,NXY0
      CHARACTER*13 WORD(6),WORD3(3)
      CHARACTER*26 WORD2(3)
C BEG JULY 1989
      CHARACTER*10 LSKIN
C BEG JUNE 1992
      COMMON/EDGCON/PEDG
      LOGICAL PEDG
C END JUNE 1992
C
      LSKIN = '   SKIN   '
      IF (ISTIF(1).EQ.5) LSKIN = 'LOWER SKIN'
C END JULY 1989
C
      DO 5 I = 1,3
    5 NTAPPL(I) = 0.
C
C     CALL ETOTAL(EPSLOD,EP0,ETHERM,ETOT1)
C     CALL ETOTAL(EPS,EPS0,ETH,ETOT2)
C     CALL ETOTAL(EPSB,EPSB0,ETHB,ETOT3)
C
      WRITE(IFILE,52)
      WRITE(IFILE,10) NX,NY,NXY,NX0,NY0,NXY0,PRELEN,LENMOD,DNEUTX,
     1                DNEUTY,ECC
C23456789012345678901234567890123456789012345678901234567890123456789012
   10 FORMAT(/' APPLIED RESULTANTS: AXIAL, Nx =',1P,E12.4,', CIRC., Ny =
     1',1P,E12.4,',  IN-PLANE SHEAR, Nxy =',1P,E12.4,' (LOAD SET A)'/
     1' APPLIED RESULTANTS: AXIAL, Nxo=',1P,E12.4,', CIRC., Nyo=
     1',1P,E12.4,',  IN-PLANE SHEAR, Nxyo=',1P,E12.4,' (LOAD SET B)'/
     1' REDUCTION FACTOR NUMBER 1 FOR THE AXIAL LENGTH OF THE PANEL:'/
     1'  (USED IN THE DETERMINATION OF THE AMPLITUDE FACTOR FOR'/
     1'  BOWING.  LESS THAN 1.0 ONLY IF THE PANEL IS CLAMPED IN THE'/
     1'  PREBUCKLING PHASE) =',1P,E12.4/
     1' REDUCTION FACTOR NUMBER 2 FOR THE AXIAL LENGTH OF THE PANEL:'/
     1'  (USED IN THE DETERMINATION OF THE BIFURCATION BUCKLING LOAD.'/
     1'  LESS THAN 1.0 ONLY IF THE PANEL IS CLAMPED IN THE BUCKLING'/
     1'  PHASE)             =',1P,E12.4/
     1' DISTANCE FROM REFER. SURFACE OF PANEL MODULE SEGMENT 1 (SKIN) TO
     1 NEUTRAL SURFACES (positive as for z in Fig. 9):'/
     1'        X-DIRECTION :     DNEUTX =',1P,E12.4/
     1'        Y-DIRECTION :     DNEUTY =',1P,E12.4//
     1' ECCENTRICITY OF AXIAL LOAD (DISTANCE FROM X-DIRECTION NEUTRAL SU
     1RFACE TO WHERE Nx AND Nxo ARE APPLIED (pos. as for z in Fig.9):'/ 
     1'    AXIAL LOAD ECCENTRICITY, ECC =',1P,E12.4)
C
C BEG FEB 2005
      IF (ECC.EQ.-DNEUTX) THEN
         WRITE(IFILE,14)
C23456789012345678901234567890123456789012345678901234567890123456789012
   14 FORMAT(/' ANY AXIAL LOADS ARE APPLIED AT THE REFER. SURFACE OF THE
     1 PANEL SKIN.'/
     1        ' IF THE PANEL HAS AXIAL STIFFENERS, THIS CAUSES AXIAL BEN
     1DING.')
         IF (.NOT.PEDG.AND.LENMOD.GT.0.9) THEN
            AXBOW = (AXIAL/2.)**2*EPSLDP(4)
            AXBOW0 = (AXIAL/2.)**2*EPSLD0(4)
            WRITE(IFILE,'(A,A,1P,E12.4,/,A,A,1P,E12.4)')
     1  ' Amplitude of axial bowing caused by all loads in Load Set A,',
     1  '  AXBOW=',AXBOW,
     1  ' Amplitude of axial bowing caused by all loads in Load Set B,',
     1  ' AXBOW0=',AXBOW0
            WRITE(IFILE,'(A)')
     1  ' This includes any amplification due to axial softening.'
         ENDIF
      ENDIF
C END FEB 2005
C
C BEG MARCH 1990
      WORD(1) = ' AXIAL STRAIN'
      WORD(2) = ' TRAN. STRAIN'
      WORD(3) = ' SHEAR STRAIN'
      WORD(4) = ' AXIAL KAPPA '
      WORD(5) = ' TRAN. KAPPA '
      WORD(6) = '    TWIST    '
C
C BEG AUG 1992
      WRDISO = 'STRINGER'
      IF (ISOGRD.EQ.1) WRDISO = ' ISOGRID'
      WRITE(IFILE,15) WRDISO
C END AUG 1992
   15 FORMAT(/
     1' AVERAGE REFERENCE SURFACE STRAINS AND CHANGES IN CURVATURE'/
     1' FOR PANEL WITH SMEARED ',A,'S AND RINGS:'//
     1'  REFERENCE    Due to Nx, Ny, Nxy    Due to Nxo, Nyo         Due 
     1to      Due to'/
     1'               Mx, My applied to     applied to panel as    press
     1ure   temperature'/
     1'   SURFACE     panel as bowed by     bowed by global im-'/
     1'               global imperfection   perfection and all'/
     1' QUANTITIES    and all loadings.     loadings.'/
     1'                    EPSLOD                EPSLD0              EAV
     1EP      ETHERM')
      DO 17 I = 1,6
         WRITE(IFILE,16) WORD(I),EPSLDP(I),EPSLD0(I),EAVEP(I),ETHRMP(I)
   16    FORMAT(A,1P,E16.4,1P,E20.4,1P,E20.4,1P,E14.4)
   17 CONTINUE
C
      IF (ISTIF(1).NE.5.AND.ISTIF(2).NE.5) THEN
C BEG AUG 1992
         WRITE(IFILE,18) WRDISO
C END AUG 1992
   18    FORMAT(/
     1' INTERNAL FORCES AND MOMENTS IN SKIN, ',A,' BASE,'/
     1' AND RING BASE FOR FOUR TYPES OF LOADING:'/
     1' 1(Nx,Ny,Nxy,Mx,My), 2(Nxo,Nyo), 3(pressure), 4(temperature)'//
     1' PART OF          I N T E R N A L   F O R C E S   A N D   M O M E
     1 N T S'/
     1'  PANEL       Nx         Ny          Nxy          Mx          My 
     1        Mt')
C
C  NEXT, CALCULATE RESULTANTS AND MOMENTS IN PARTS 1, 2, AND 3 (SEE
C  FIG. 14 OF THE LONG PANDA2 PAPER FOR DEFINITION OF PARTS 1, 2, 3...
C
         WORD4(1) = '  SKIN  '
         WORD4(2) = ' STRBASE'
C BEG AUG 1992
         IF (ISOGRD.EQ.1) WORD4(2) = '  SKIN  '
C END AUG 1992
         WORD4(3) = ' RNGBASE'
C  FIRST, DO IT FOR THE APPLIED EIGENVALUE LOADS Nx,Ny,Nxy,Mx,My...
         CALL RES2(1,CX(1,1,1),THSMRX(1,1),EPSLOD,0.,RESCHK)
         CALL RES2(2,CX(1,1,2),THSMRX(1,2),EPS,   0.,RESCHK)
         CALL RES2(3,CY(1,1,2),THSMRY(1,2),EPSB,  0.,RESCHK)
         WRITE(IFILE,19)
   19    FORMAT(/' Internal forces and moments from Nx,Ny,Nxy,Mx,My:')
         DO 22 I = 1,3
            WRITE(IFILE,20) WORD4(I),(RESCHK(J,I),J=1,6)
   20       FORMAT(A,1P,6E12.4)
   22    CONTINUE
C  NEXT, DO IT FOR THE APPLIED FIXED LOADS Nxo,Nyo...
         CALL RES2(1,CX(1,1,1),THSMRX(1,1),EP0,   0.,RESCHK)
         CALL RES2(2,CX(1,1,2),THSMRX(1,2),EPS0,  0.,RESCHK)
         CALL RES2(3,CY(1,1,2),THSMRY(1,2),EPSB0, 0.,RESCHK)
         WRITE(IFILE,23)
   23    FORMAT(/' Internal forces and moments from Nxo, Nyo:')
         DO 24 I = 1,3
            WRITE(IFILE,20) WORD4(I),(RESCHK(J,I),J=1,6)
   24    CONTINUE
C  NEXT, DO IT FOR THE PRESSURE...
         CALL RES2(1,CX(1,1,1),THSMRX(1,1),EPP,   0.,RESCHK)
         CALL RES2(2,CX(1,1,2),THSMRX(1,2),EPSP,  0.,RESCHK)
         CALL RES2(3,CY(1,1,2),THSMRY(1,2),EPSBP, 0.,RESCHK)
         IF (.NOT.PEDG) WRITE(IFILE,25)
   25    FORMAT(/' Internal forces and moments from overall response of
     1 the panel to pressure, p:')
         IF (PEDG) WRITE(IFILE,'(A,/,A)')
     1    ' Internal forces and moments from overall',
     1    ' response of the panel to pressure, p (Load Set A):'
         DO 26 I = 1,3
            WRITE(IFILE,20) WORD4(I),(RESCHK(J,I),J=1,6)
   26    CONTINUE
C BEG OCT 1998
C  NEXT, DO IT FOR THE PRESSURE...(LOAD SET B, CURVED PANEL)
         IF (PEDG) THEN
            CALL RES2(1,CX(1,1,1),THSMRX(1,1),EPPB,  0.,RESCHK)
            CALL RES2(2,CX(1,1,2),THSMRX(1,2),EPSPB, 0.,RESCHK)
            CALL RES2(3,CY(1,1,2),THSMRY(1,2),EPSBPB,0.,RESCHK)
            WRITE(IFILE,'(A,/,A)')
     1    ' Internal forces and moments from overall',
     1    ' response of the panel to pressure, p (Load Set B):'
            DO 261 I = 1,3
               WRITE(IFILE,20) WORD4(I),(RESCHK(J,I),J=1,6)
  261       CONTINUE
         ENDIF
C END OCT 1998
C  NEXT, DO IT FOR THE THERMAL LOADS...
         CALL RES2(1,CX(1,1,1),THSMRX(1,1),ETHERM,1.,RESCHK)
         CALL RES2(2,CX(1,1,2),THSMRX(1,2),ETH,   1.,RESCHK)
C BEG SEPT 1990
         IF (ISTIF(2).NE.0.) THEN
            CALL RES2(3,CY(1,1,2),THSMRY(1,2),ETHB,  1.,RESCHK)
         ELSE
            CALL MOVER(0.,0,RESCHK(1,3),1,6)
         ENDIF
C END SEPT 1990
         WRITE(IFILE,27)
   27    FORMAT(/' Internal forces and moments from thermal loads:')
         DO 28 I = 1,3
            WRITE(IFILE,20) WORD4(I),(RESCHK(J,I),J=1,6)
   28    CONTINUE
         WRITE(IFILE,30)
   30    FORMAT(' ======================================================
     1===============')
      ENDIF
C
C BEG SEPT 1990
      WORDAB = '(LOAD SET B)'
      IF (IABT.EQ.1) WORDAB = '(LOAD SET A)'
C BEG AUG 1992
      WRITE(IFILE,48) WORDAB,WRDISO,WRDISO,WRDISO
   48 FORMAT(/
     1' REFERENCE SURFACE (SKIN REFER. SURFACE) STRAINS, CHANGES IN CURV
     1ATURE, AND TWIST CAUSED BY APPLIED IN-PLANE LOADS, Nx, Ny, Nxy'/
     1' AND Nxo, Nyo, Nxyo AND CAUSED BY THERMAL LOADING'//
     1' REFERENCE       CAUSED BY APPLIED LOADS, Nx,Ny,Nxy  CAUSED BY AP
     1PLIED LOADS, Nxo,Nyo,Nxyo      CAUSED BY THERMAL LOADING'/
     1'  SURFACE                  (LOAD SET A)                        (L
     1OAD SET B)                             ',A/
     1' QUANTITIES         SKIN  ',A   ,' BASE RING BASE         SKIN    
     1',A   ,' BASE RING BASE        SKIN  ',A   ,' BASE RING BASE')
C END AUG 1992
C END SEPT 1990
C
C BEG MARCH 1990
C    WORD(1) THROUGH WORD(6) MOVED UP
C END MARCH 1990
C
      DO 50 I = 1,6
      WRITE(IFILE,40) WORD(I),EPSLOD(I),EPS(I),EPSB(I),
     1                        EP0(I),  EPS0(I),EPSB0(I),
     1                        ETHERM(I),ETH(I),ETHB(I)
   40 FORMAT(A13,3X,1P,3E11.3,5X,1P,3E11.3,5X,1P,3E11.3)
   50 CONTINUE
      WRITE(IFILE,52)
   52 FORMAT(' =========================================================
     1================================================================')
C BEG MAR 1993
      IF (.NOT.PEDG) WRITE(IFILE,53)
      IF (PEDG) WRITE(IFILE,54)
   53 FORMAT('              CAUSED BY ALL LOADS EXCEPT NORMAL PRESSURE')
   54 FORMAT('                        CAUSED BY ALL LOADS')
C END MAR 1993
C
C BEG AUG 1992
      WRITE(IFILE,55) WORDAB,LSKIN,WRDISO,LSKIN,WRDISO,LSKIN,WRDISO
   55 FORMAT( '        S T R A I N S     I N   V A R I O U S   P A R T S
     1  O F   T H E   P A N E L   S K I N   A N D   S T I F F E N E R S'
     1/
     1'     ITEM        CAUSED BY APPLIED LOADS, Nx,Ny,Nxy  CAUSED BY AP
     1PLIED LOADS, Nxo,Nyo,Nxyo      CAUSED BY THERMAL LOADING'/
     1'                           (LOAD SET A)                        (L
     1OAD SET B)                             ',A/
     1'                 '  ,A,   '  ',A   ,'     RING         '  ,A,   ' 
     1  ',A   ,'     RING         '  ,A,   '  ',A   ,'     RING')
C
      CALL OUTPRT(IFILE,NSEG,EPSEIG,EPSFXL,EPSFIX,ISTIF,
     1    ISOGRD,ISOANG,ESEIG,ESFXL,ESFIX,0,WBEIG,WBFXL,WBFIX,WRDISO)
C
C BEG MAR 1993
      IF (.NOT.PEDG) WRITE(IFILE,53)
      IF (PEDG) WRITE(IFILE,54)
C END MAR 1993
      WRITE(IFILE,60) WORDAB,LSKIN,WRDISO,LSKIN,WRDISO,LSKIN,WRDISO
   60 FORMAT( '    R E S U L T A N T S   I N   V A R I O U S   P A R T S
     1  O F   T H E   P A N E L   S K I N   A N D   S T I F F E N E R S'
     1/
     1'     ITEM        CAUSED BY APPLIED LOADS, Nx,Ny,Nxy  CAUSED BY AP
     1PLIED LOADS, Nxo,Nyo,Nxyo      CAUSED BY THERMAL LOADING'/
     1'                           (LOAD SET A)                        (L
     1OAD SET B)                             ',A/
     1'                 '  ,A,   '  ',A   ,'     RING         '  ,A,   ' 
     1  ',A   ,'     RING         '  ,A,   '  ',A   ,'     RING')
C
      CALL OUTPRT(IFILE,NSEG,RESEIG,RESFXL,RESFIX,ISTIF,
     1   ISOGRD,ISOANG,RSEIG,RSFXL,RSFIX,1,WBEIG,WBFXL,WBFIX,WRDISO)
C END AUG 1992
C
C  CHECK FOR EQUILIBRIUM OF FORCES...
C
C BEG MAR 1993
      IF (.NOT.PEDG) WRITE(IFILE,53)
      IF (PEDG) WRITE(IFILE,54)
C END MAR 1993
C BEG SEPT 1990
      WRITE(IFILE,70) WORDAB
   70 FORMAT( '       E Q U I L I B R I U M   O F   R E S U L T A N T S 
     1  F R O M   A P P L I E D   A N D   T H E R M A L   L O A D S'/
     1'     ITEM        CAUSED BY APPLIED LOADS, Nx,Ny,Nxy  CAUSED BY AP
     1PLIED LOADS, Nxo,Nyo,Nxyo      CAUSED BY THERMAL LOADING'/
     1'                           (LOAD SET A)                        (L
     1OAD SET B)                             ',A/
     1'                     Nx         Ny        Nxy             Nx     
     1     Ny        Nxy              Nx         Ny        Nxy'/)
C END SEPT 1990
C
C BEG AUG 1992
      CALL EQUFCE(ISTIF,B,B2,H,W,W2,RESEIG,RSEIG,NEIG)
      CALL EQUFCE(ISTIF,B,B2,H,W,W2,RESFIX,RSFIX,NFIX)
      CALL EQUFCE(ISTIF,B,B2,H,W,W2,RESFXL,RSFXL,NFXL)
C END AUG 1992
      DO 80 I = 1,3
   80 NTOT(I) = NEIG(I) + NFXL(I) + NFIX(I)
      WORD3(1) = '   DERIVED   '
      WORD3(2) = '   APPLIED   '
      WORD3(3) = ' DIFFERENCE  '
C
      WRITE(IFILE,40) WORD3(1),
     1            (NEIG(I),I=1,3),(NFXL(I),I=1,3),(NFIX(I),I=1,3)
      WRITE(IFILE,40) WORD3(2),NX,NY,NXY,NX0,NY0,NXY0,(NTAPPL(I),I=1,3)
      WRITE(IFILE,40) WORD3(3),NEIG(1)-NX,NEIG(2)-NY,NEIG(3)-NXY,
     1                        NFXL(1)-NX0,NFXL(2)-NY0,NFXL(3)-NXY0,
     1                        (NFIX(I)-NTAPPL(I),I=1,3)
C
      WRITE(IFILE,52)
      WRITE(IFILE,52)
C
      FNXYP0 = 0.
      FNXYPL = 0.
C BEG MAR 1993
      IF (PEDG) GO TO 160
      IF (P.EQ.0.) GO TO 160
C END MAR 1993
      IF (IABP.EQ.0) THEN
        WRITE(IFILE,90) P,FNXP0,FNYP0,FNXYP0,FNXPL0,FNYPL0,FNXYPL
      ELSE
        WRITE(IFILE,92) P,FNXP0,FNYP0,FNXYP0,FNXPL0,FNYPL0,FNXYPL
      ENDIF
C
   90 FORMAT(/' APPLIED UNIFORM NORMAL PRESSURE, P=',1P,E12.4/
     1' IN-PLANE RESULTANTS DEVELOPED FROM MODEL OF ENTIRE PANEL WITH SM
     1EARED STIFFENERS (considered part of Load Set B):'/
     1'      Nx(created by normal pressure) =',1P,E12.4/
     1'      Ny(created by normal pressure) =',1P,E12.4/
     1'     Nxy(created by normal pressure) =',1P,E12.4//
     1' IN-PLANE RESULTANTS DEVELOPED FROM MODEL OF PANEL MODULE WITH BR
     1ANCHED STRINGER  (considered part of Load Set B):'/
     1'      Nx(created by normal pressure) =',1P,E12.4/
     1'      Ny(created by normal pressure) =',1P,E12.4/
     1'     Nxy(created by normal pressure) =',1P,E12.4)
C
   92 FORMAT(/' APPLIED UNIFORM NORMAL PRESSURE, P=',1P,E12.4/
     1' IN-PLANE RESULTANTS DEVELOPED FROM MODEL OF ENTIRE PANEL WITH SM
     1EARED STIFFENERS (considered part of Load Set A):'/
     1'      Nx(created by normal pressure) =',1P,E12.4/
     1'      Ny(created by normal pressure) =',1P,E12.4/
     1'     Nxy(created by normal pressure) =',1P,E12.4//
     1' IN-PLANE RESULTANTS DEVELOPED FROM MODEL OF PANEL MODULE WITH BR
     1ANCHED STRINGER  (considered part of Load Set A):'/
     1'      Nx(created by normal pressure) =',1P,E12.4/
     1'      Ny(created by normal pressure) =',1P,E12.4/
     1'     Nxy(created by normal pressure) =',1P,E12.4)
C
      IF (P.EQ.0.) GO TO 160
      IF (IABP.EQ.0) THEN
C BEG AUG 1992  
         WRITE(IFILE,100) WRDISO
      ELSE
         WRITE(IFILE,102) WRDISO
C END AUG 1992
      ENDIF
  100 FORMAT(/' REFERENCE SURFACE (skin refer. surface) STRAINS, CHANGES 
     1IN CURVATURE, AND TWIST CAUSED BY UNIFORM NORMAL PRESSURE'/
     1'        (entire panel, smeared stiffener model)'//
     1' REFERENCE      CAUSED BY UNIFORM NORMAL PRESSURE, P'/
     1'  SURFACE       (considered part of Load Set B)'/
     1' QUANTITIES         SKIN  ',A   ,' BASE   RING')
C
  102 FORMAT(/' REFERENCE SURFACE (skin refer. surface) STRAINS, CHANGES 
     1IN CURVATURE, AND TWIST CAUSED BY UNIFORM NORMAL PRESSURE'/
     1'        (entire panel, smeared stiffener model)'//
     1' REFERENCE      CAUSED BY UNIFORM NORMAL PRESSURE, P'/
     1'  SURFACE       (considered part of Load Set A)'/
     1' QUANTITIES         SKIN  ',A   ,' BASE   RING')
C
      DO 110 I = 1,6
         WRITE(IFILE,120) WORD(I), EPP(I),EPSP(I),EPSBP(I)
  120    FORMAT(A13,3X,1P,3E11.3)
  110 CONTINUE
      WRITE(IFILE,52)
C
      DO 125 I = 1,3
      DO 125 J = 1,5
      DO 125 K = 1,2
      RESSUM(I,J,K) = RESPRS(I,J,K) + RESPGL(I,J,K)
  125 EPSSUM(I,J,K) = EPSPRS(I,J,K) + EPSPGL(I,J,K)
      WRITE(IFILE,126)
  126 FORMAT('                        CAUSED BY UNIFORM PRESSURE')
      IF (IABP.EQ.0) THEN
C BEG AUG 1992
         WRITE(IFILE,130) LSKIN,WRDISO,LSKIN,WRDISO,LSKIN,WRDISO
      ELSE
         WRITE(IFILE,132) LSKIN,WRDISO,LSKIN,WRDISO,LSKIN,WRDISO
      ENDIF
  130 FORMAT( '        S T R A I N S     I N   V A R I O U S   P A R T S
     1  O F   T H E   P A N E L   S K I N   A N D   S T I F F E N E R S'
     1/
     1'     ITEM        FROM MODEL OF ENTIRE PANEL(smeared) FROM MODEL O
     1F PANEL MODULE(branched)    SUM OF STRAINS FROM BOTH MODELS'/
     1'                           (LOAD SET B)                        (L
     1OAD SET B)                  (Considered part of load set B)'/
     1'                 '  ,A,   '  ',A   ,'     RING         '  ,A,   ' 
     1  ',A   ,'     RING         '  ,A,   '  ',A   ,'     RING')
C
  132 FORMAT( '        S T R A I N S     I N   V A R I O U S   P A R T S
     1  O F   T H E   P A N E L   S K I N   A N D   S T I F F E N E R S'
     1/
     1'     ITEM        FROM MODEL OF ENTIRE PANEL(smeared) FROM MODEL O
     1F PANEL MODULE(branched)    SUM OF STRAINS FROM BOTH MODELS'/
     1'                           (LOAD SET A)                        (L
     1OAD SET A)                  (Considered part of load set A)'/
     1'                 '  ,A,   '  ',A   ,'     RING         '  ,A,   ' 
     1  ',A   ,'     RING         '  ,A,   '  ',A   ,'     RING')
C
      CALL OUTPRT(IFILE,NSEG,EPSPGL,EPSPRS,EPSSUM,ISTIF,
     1     ISOGRD,ISOANG,ESPGL,ESPRS,ESPGL,0,WBPGL,WBPRS,WBPGL,WRDISO)
C
      WRITE(IFILE,126)
      IF (IABP.EQ.0) THEN
         WRITE(IFILE,140) LSKIN,WRDISO,LSKIN,WRDISO,LSKIN,WRDISO
      ELSE
         WRITE(IFILE,142) LSKIN,WRDISO,LSKIN,WRDISO,LSKIN,WRDISO
      ENDIF
  140 FORMAT( '    R E S U L T A N T S   I N   V A R I O U S   P A R T S
     1  O F   T H E   P A N E L   S K I N   A N D   S T I F F E N E R S'
     1/
     1'     ITEM        FROM MODEL OF ENTIRE PANEL(smeared) FROM MODEL 0
     1F PANEL MODULE(branched)   SUM OF RESULTANTS FROM BOTH MODELS'/
     1'                           (LOAD SET B)                        (L
     1OAD SET B)                  (Considered part of load set B)'/
     1'                 '  ,A,   '  ',A   ,'     RING         '  ,A,   ' 
     1  ',A   ,'     RING         '  ,A,   '  ',A   ,'     RING')
C
  142 FORMAT( '    R E S U L T A N T S   I N   V A R I O U S   P A R T S
     1  O F   T H E   P A N E L   S K I N   A N D   S T I F F E N E R S'
     1/
     1'     ITEM        FROM MODEL OF ENTIRE PANEL(smeared) FROM MODEL 0
     1F PANEL MODULE(branched)   SUM OF RESULTANTS FROM BOTH MODELS'/
     1'                           (LOAD SET A)                        (L
     1OAD SET A)                  (Considered part of load set A)'/
     1'                 '  ,A,   '  ',A   ,'     RING         '  ,A,   ' 
     1  ',A   ,'     RING         '  ,A,   '  ',A   ,'     RING')
C
      CALL OUTPRT(IFILE,NSEG,RESPGL,RESPRS,RESSUM,ISTIF,
     1   ISOGRD,ISOANG,RSPGL,RSPRS,RSPGL,1,WBPGL,WBPRS,WBPGL,WRDISO)
C END AUG 1992
      WRITE(IFILE,52)
C
C
C  CHECK FOR EQUILIBRIUM OF FORCES...
C
      WRITE(IFILE,126)
      IF (IABP.EQ.0) THEN
         WRITE(IFILE,150)
      ELSE
         WRITE(IFILE,152)
      ENDIF
  150 FORMAT( '       E Q U I L I B R I U M   O F   R E S U L T A N T S 
     1  F R O M   A P P L I E D   N O R M A L   P R E S S U R E, P'/
     1'     ITEM        FROM MODEL OF ENTIRE PANEL(smeared) FROM MODEL 0
     1F PANEL MODULE(branched)   SUM OF RESULTANTS FROM BOTH MODELS'/
     1'                           (LOAD SET B)                        (L
     1OAD SET B)                  (Considered part of load set B)'/
     1'                     Nx         Ny        Nxy             Nx     
     1     Ny        Nxy              Nx         Ny        Nxy'/)
C
  152 FORMAT( '       E Q U I L I B R I U M   O F   R E S U L T A N T S 
     1  F R O M   A P P L I E D   N O R M A L   P R E S S U R E, P'/
     1'     ITEM        FROM MODEL OF ENTIRE PANEL(smeared) FROM MODEL 0
     1F PANEL MODULE(branched)   SUM OF RESULTANTS FROM BOTH MODELS'/
     1'                           (LOAD SET A)                        (L
     1OAD SET A)                  (Considered part of load set A)'/
     1'                     Nx         Ny        Nxy             Nx     
     1     Ny        Nxy              Nx         Ny        Nxy'/)
C
      NTAPPL(1) = FNXP0 + FNXPL0
      NTAPPL(2) = FNYP0 + FNYPL0
      NTAPPL(3) = FNXYP0+ FNXYPL
C
C BEG AUG 1992
      CALL EQUFCE(ISTIF,B,B2,H,W,W2,RESPGL,RSPGL,NEIG)
      CALL EQUFCE(ISTIF,B,B2,H,W,W2,RESSUM,RSPGL,NFIX)
      CALL EQUFCE(ISTIF,B,B2,H,W,W2,RESPRS,RSPRS,NFXL)
C END AUG 1992
      WORD3(1) = ' FROM EQUFCE '
      WORD3(2) = ' FROM EQUILIB'
      WORD3(3) = ' DIFFERENCE  '
C
C BEG JUNE 1992
      IF (.NOT.PEDG) THEN
         WRITE(IFILE,40) WORD3(1),
     1            (NEIG(I),I=1,3),(NFXL(I),I=1,3),(NFIX(I),I=1,3)
         WRITE(IFILE,40) WORD3(2),FNXP0,FNYP0,FNXYP0,
     1                    FNXPL0,FNYPL0,FNXYPL,(NTAPPL(I),I=1,3)
         WRITE(IFILE,40) WORD3(3),NEIG(1)-FNXP0,NEIG(2)-FNYP0,
     1                                       NEIG(3)-FNXYP0,
     1       NFXL(1)-FNXPL0,NFXL(2)-FNYPL0,NFXL(3)-FNXYPL,
     1                        (NFIX(I)-NTAPPL(I),I=1,3)
      ENDIF
C END JUNE 1992
C
      WRITE(IFILE,52)
      WRITE(IFILE,52)
C
  160 CONTINUE
      RETURN
      END
C
C
C
C=DECK      OUTPRT
C BEG AUG 1992
      SUBROUTINE OUTPRT(IFILE,NSEG,EIG,FIX,TOT,ISTIF,
     1               ISOGRD,ISOANG,EIG2,FIX2,TOT2,
     1               IPSWX,WBEIG,WBFXL,WBFIX,WRDISO)
C
C  PURPOSE IS TO PRINT OUT RESULTANTS AND STRAINS IN PANEL PARTS.
C
      DIMENSION EIG(3,5,2),FIX(3,5,2),TOT(3,5,2),NSEG(*),ISTIF(*)
      DIMENSION EIG2(3,5,3),FIX2(3,5,3),TOT2(3,5,3)
      DIMENSION WBEIG(2,4,2),WBFXL(2,4,2),WBFIX(2,4,2)
C
      CHARACTER*15 WORD3(3)
      CHARACTER*8 WRDISO
C END AUG 1992
      CHARACTER*13 WORD(6)
      CHARACTER*26 WORD2(3)
C
      WORD(1) = '  SKIN AXIAL '
      WORD(2) = '  SKIN CIRC. '
      WORD(3) = '  SKIN SHEAR '
C
      DO 80 I = 1,3
      WRITE(IFILE,70) WORD(I),EIG(I,1,1),FIX(I,1,1),TOT(I,1,1)
   70 FORMAT(A13,3X,1P,E11.3,'     -          -     ',5X,1P,E11.3,
     1'     -          -     ',5X,1P,E11.3,'     -          -')
   80 CONTINUE
C BEG AUG 1992
      WRITE(IFILE,82) WRDISO,WRDISO,WRDISO
   82 FORMAT(
     1'                             ',A   ,'     RING                    
     1  ',A   ,'     RING                     ',A   ,'     RING')
C END AUG 1992
   85 FORMAT(' ')
C
      WORD2(1) = ' STIFFENER BASE ALONG AXIS'
      WORD2(2) = ' STIFFENER BASE TRANSVERSE'
      WORD2(3) = ' STIFFENER BASE   SHEAR   '
C
C BEG JULY 1989
      IWEB1 = 3
      IF (ISTIF(1).EQ.5) IWEB1 = 2
      IWEB1M = IWEB1 - 1
      IWEB2 = 3
      IF (ISTIF(2).EQ.5) IWEB2 = 2
      IWEB2M = IWEB2 - 1
C
      IF (ISTIF(1).NE.5.AND.ISTIF(2).NE.5) THEN
         DO 100 I = 1,3
         WRITE(IFILE,90) WORD2(I),EIG(I,IWEB1M,1),EIG(I,IWEB2M,2),
     1                            FIX(I,IWEB1M,1),FIX(I,IWEB2M,2),
     1                            TOT(I,IWEB1M,1),TOT(I,IWEB2M,2)
C
   90    FORMAT(A26,1P,2E11.3,16X,1P,2E11.3,16X,1P,2E11.3)
  100    CONTINUE
      ENDIF
      WRITE(IFILE,85)
C
      IF (NSEG(1).LT.3.AND.NSEG(2).LT.3) GO TO 140
C
C BEG AUG 1992
      IF (ISOGRD.EQ.0) THEN
         WORD2(1) = ' ALONG STIFFENER WEB AXIS'
         WORD2(2) = ' TRANSVERSE  TO  WEB AXIS'
         WORD2(3) = ' IN-PLANE SHEARING OF WEB'
C
         DO 110 I = 1,3
         WRITE(IFILE,90) WORD2(I),EIG(I,IWEB1,1),EIG(I,IWEB2,2),
     1                            FIX(I,IWEB1,1),FIX(I,IWEB2,2),
     1                            TOT(I,IWEB1,1),TOT(I,IWEB2,2)
  110    CONTINUE
         WRITE(IFILE,85)
         IF (IPSWX.EQ.1) THEN
            WRITE(IFILE,111)
  111       FORMAT(' AXIAL RESULTANTS AT THE ROOT AND TIP OF WEBS:')
            WORD2(1) = ' AT THE ROOT OF THE WEBS '
            WORD2(2) = ' AT THE TIP  OF THE WEBS '
            DO 112 I = 1,2
            WRITE(IFILE,90) WORD2(I),WBEIG(I,1,1),WBEIG(I,4,2),
     1                               WBFXL(I,1,1),WBFXL(I,4,2),
     1                               WBFIX(I,1,1),WBFIX(I,4,2)
  112       CONTINUE
            WRITE(IFILE,85)
         ENDIF
      ELSE
         IF (IPSWX.EQ.1.AND.ISTIF(2).NE.0) THEN
            WRITE(IFILE,113)
  113       FORMAT(' RESULTANT ALONG AXIS OF WEBS OF RINGS:')
            WORD2(1) = ' AT THE ROOT OF THE WEBS '
            WORD2(2) = ' AT THE TIP  OF THE WEBS '
            DO 1132 I = 1,2
            WRITE(IFILE,1133) WORD2(I),WBEIG(I,4,2),
     1                                 WBFXL(I,4,2),
     1                                 WBFIX(I,4,2)
 1132       CONTINUE
 1133       FORMAT(A26,11X,1P,E11.3,27X,1P,1E11.3,27X,1P,E11.3)
            WRITE(IFILE,85)
            WRITE(IFILE,1134)
 1134       FORMAT(' TRANSVERSE AND SHEAR RESULTANTS IN WEBS OF RINGS:')
            WORD2(2) = ' TRANSVERSE  TO  WEB AXIS'
            WORD2(3) = ' IN-PLANE SHEARING OF WEB'
            DO 1135 I = 2,3
            WRITE(IFILE,1133) WORD2(I),EIG(I,IWEB2,2),
     1                                 FIX(I,IWEB2,2),
     1                                 TOT(I,IWEB2,2)
 1135       CONTINUE
            WRITE(IFILE,85)
            IF (NSEG(2).GT.3) THEN
               WRITE(IFILE,1136)
 1136          FORMAT(' RESULTANTS IN OUTSTANDING FLANGES OF RINGS:')
               WORD2(1) = ' ALONG STIFF. FLANGE AXIS'
               WORD2(2) = ' TRANSVERSE TO FLANGE AX.'
               WORD2(3) = ' IN-PLANE SHEAR OF FLANGE'
               DO 1137 I = 1,3
                  WRITE(IFILE,1133) WORD2(I),EIG(I,4,2),
     1                                       FIX(I,4,2),
     1                                       TOT(I,4,2)
 1137          CONTINUE
               WRITE(IFILE,85)
            ENDIF
         ENDIF
         THET1 = 30.
         THET3 = 90.
         IF (ISOANG.EQ.2) THEN
            THET1 = 60.
            THET3 = 0.
         ENDIF
         WRITE(IFILE,114) THET1,-THET1,THET3
  114    FORMAT(/
     1 ' ISOGRID CONFIGURATION: STIFFENERS 1, 2, 3 ARE AT ANGLES',
     1   1P,E12.2,', ',1P,E12.2,', ',1P,E12.2,',  RESPECTIVELY.'/
     1 ' STIFFENER NO.       1          2          3               1',
     1 '          2          3               1          2          3')
         WRITE(IFILE,115)
  115    FORMAT(' AVERAGE VALUES IN THE ISOGRID WEBS:')
         WORD3(1) = '   ALONG AXIS  '
         WORD3(2) = '   TRANSVERSE  '
         WORD3(3) = ' IN-PLANE SHEAR'
         DO 117 I = 1,3
         WRITE(IFILE,116) WORD3(I),EIG2(I,3,1),EIG2(I,3,2),EIG2(I,3,3),
     1                             FIX2(I,3,1),FIX2(I,3,2),FIX2(I,3,3),
     1                             TOT2(I,3,1),TOT2(I,3,2),TOT2(I,3,3)
  116    FORMAT(A15,1P,3E11.3,5X,1P,3E11.3,5X,1P,3E11.3)
  117    CONTINUE
         WRITE(IFILE,85)
         IF (IPSWX.EQ.1) THEN
            WRITE(IFILE,111)
            WORD3(1) = ' AT ROOT OF WEB'
            WORD3(2) = ' AT TIP  OF WEB'
            DO 118 I = 1,2
            WRITE(IFILE,116)
     1                  WORD3(I),WBEIG(I,1,1),WBEIG(I,2,1),WBEIG(I,3,1),
     1                           WBFXL(I,1,1),WBFXL(I,2,1),WBFXL(I,3,1),
     1                           WBFIX(I,1,1),WBFIX(I,2,1),WBFIX(I,3,1)
  118       CONTINUE
            WRITE(IFILE,85)
         ENDIF
      ENDIF
C
      IF (NSEG(1).LT.4.AND.NSEG(2).LT.4) GO TO 140
C
      IF (ISOGRD.EQ.0) THEN
         WORD2(1) = ' ALONG STIFF. FLANGE AXIS'
         WORD2(2) = ' TRANSVERSE TO FLANGE AX.'
         WORD2(3) = ' IN-PLANE SHEAR OF FLANGE'
         DO 120 I = 1,3
         WRITE(IFILE,90) WORD2(I),EIG(I,4,1),EIG(I,4,2),
     1                            FIX(I,4,1),FIX(I,4,2),
     1                            TOT(I,4,1),TOT(I,4,2)
  120    CONTINUE
      ELSE
         WRITE(IFILE,125)
  125    FORMAT(' AVERAGE VALUES IN THE ISOGRID FLANGE:')
         WORD3(1) = '   ALONG AXIS  '
         WORD3(2) = '   TRANSVERSE  '
         WORD3(3) = ' IN-PLANE SHEAR'
         DO 127 I = 1,3
         WRITE(IFILE,116) WORD3(I),EIG2(I,4,1),EIG2(I,4,2),EIG2(I,4,3),
     1                             FIX2(I,4,1),FIX2(I,4,2),FIX2(I,4,3),
     1                             TOT2(I,4,1),TOT2(I,4,2),TOT2(I,4,3)
  127    CONTINUE
         WRITE(IFILE,85)
      ENDIF
C END AUG 1992
C
  140 CONTINUE
C
C BEG JULY 1989
      IF (ISTIF(1).EQ.5.OR.ISTIF(2).EQ.5) THEN
         WORD2(1) = '    UPPER SKIN AXIAL     '
         WORD2(2) = '  UPPER SKIN CIRCUMFER.  '
         WORD2(3) = '    UPPER SKIN SHEAR     '
         DO 150 I = 1,3
            WRITE(IFILE,90) WORD2(I),EIG(I,3,1),EIG(I,3,2),
     1                               FIX(I,3,1),FIX(I,3,2),
     1                               TOT(I,3,1),TOT(I,3,2)
  150    CONTINUE
C BEG AUG 1992
         WRITE(IFILE,85)
         IF (IPSWX.EQ.1) THEN
            WRITE(IFILE,111)
            WORD2(1) = ' AT THE ROOT OF THE WEBS '
            WORD2(2) = ' AT THE TIP  OF THE WEBS '
            DO 152 I = 1,2
            WRITE(IFILE,90) WORD2(I),WBEIG(I,1,1),WBEIG(I,4,2),
     1                               WBFXL(I,1,1),WBFXL(I,4,2),
     1                               WBFIX(I,1,1),WBFIX(I,4,2)
  152       CONTINUE
         ENDIF
C END AUG 1992
      ENDIF
C
C END JULY 1989
      WRITE(IFILE,130)
  130 FORMAT(' =========================================================
     1===============================================================')
C
      RETURN
      END
C
C
C
C=DECK      EQUFCE
C BEG AUG 1992
      SUBROUTINE EQUFCE(ISTIF,B,B2,H,W,W2,RES,RS,NAPPL)
C
C  PURPOSE IS TO ADD UP FORCES TO CHECK FOR EQUILIBRIUM..
C
      COMMON/ISOGR/ISOGRD,ISOANG
C BEG APR 1996
      COMMON/GEOM6/IFAY(2),ITRTOT,IRESET,NLOADS,NSTEPS,WMAXXX,NCROSS,
     1       NOPLOT,KMAX,ILAYPL,XMAX,XMIN,YMAX,YMIN,N3DPLT,NOBJ,NSTRNS,
     1       NPLTST,NABSCI,IDIAG,ITRALL,IFAYT(2),IBEAM,IMISCL(5)
C END APR 1996
C BEG MAY 1997
      COMMON/IZSTIX/IZSTIF(2)
C END MAY 1997
      DIMENSION NAPPL(*),ISTIF(*),B(*),B2(*),H(*),W(*),W2(*),RES(3,5,2)
      DIMENSION B11(2),B12(2),RS(3,5,3),FRIB(3)
      REAL NAPPL
C
      IF (ISOGRD.EQ.0) THEN
         DO 12 I = 1,2
            B11(I) = (B(I) - B2(I))/B(I)
            B12(I) = B2(I)/B(I)
C BEG MAY 1997
            IF (IZSTIF(I).EQ.1) THEN
               B11(I) = 1.0
               B12(I) = 0.0
            ENDIF
C END MAY 1997
C
C  NOTE:  IFAY(i) = 1 MEANS THAT:
C          1. THE STIFFENER IS A HAT.
C          2. THE BASE WIDTH B2(i) IS GREATER THAN THE HAT WIDTH W2(i)
C          3. THE WALL UNDER THE HAT IS THE SAME AS THAT IN SEGMENT 1.
C
            IF (IFAY(I).EQ.1) THEN
               B11(I) = (B(I) - (B2(I)-W2(I)))/B(I)
               B12(I) = (B2(I) - W2(I))/B(I)
            ENDIF
C BEG NOV 1995
            IF (ISTIF(I).EQ.5) THEN
               B11(I) = 1.0
               B12(I) = 0.0
            ENDIF
C END NOV 1995
C
            IF (ISTIF(I).NE.4) THEN
               ARCC = H(I)
            ELSE
               ARCC = 2.*SQRT(H(I)**2 +.25*(W2(I)-W(I))**2)
            ENDIF
C BEG MAY 1997
            IF (ISTIF(I).NE.5) THEN
               NAPPL(I) =   RES(1,1,I)*B11(I) +RES(1,2,I)*B12(I) 
     1                  +(RES(1,3,I)*ARCC +RES(1,4,I)*W(I) )/B(I)
               IF (IZSTIF(I).EQ.1)
     1             NAPPL(I) = NAPPL(I) + RES(1,2,I)*B2(I)/B(I)
            ENDIF
C END MAY 1997
            IF (ISTIF(I).EQ.5) THEN
C BEG NOV 1995
               ARCC = 2.*SQRT(H(I)**2 + .25*(B(I)-2.*B2(I))**2)
C END NOV 1995
               NAPPL(I) = RES(1,1,I) 
     1                  +(RES(1,2,I)*ARCC +RES(1,3,I)*B(I) )/B(I)
C BEG APR 1996
     1                  +2.*FLOAT(IFAYT(I))*RES(1,2,I)*B2(I)/B(I)
C END APR 1996
            ENDIF
   12    CONTINUE
         IF (ISTIF(1).EQ.5) NAPPL(2) = RES(2,1,1) + RES(2,3,1)
         IF (ISTIF(2).EQ.5) NAPPL(1) = RES(2,1,2) + RES(2,3,2)
         IF (ISTIF(1).NE.5.AND.ISTIF(2).NE.5)
     1         NAPPL(3) =     RES(3,1,1)*B11(1) +RES(3,2,1)*B12(1)
         IF (ISTIF(1).EQ.5.OR.ISTIF(2).EQ.5)
C BEG NOV 1995
C    1         NAPPL(3) = RES(3,1,1) + RES(3,2,1) + RES(3,3,1)
     1         NAPPL(3) = RES(3,1,1) + RES(3,3,1)
     1                   +RES(3,2,1)*(B(1)-2.*B2(1))/B(1)
C END NOV 1995
      ELSE
         PI = 3.1415927
         THET = 30.*PI/180.
         IF (ISOANG.EQ.2) THET = 60.*PI/180.
         CT = COS(THET)
         ST = SIN(THET)
         DO 20 I = 1,3
            FRIB(I) = RS(1,3,I)*H(1) +RS(1,4,I)*W(1)
   20    CONTINUE
         IF (ISOANG.EQ.1) THEN
            DNX = (FRIB(1) + FRIB(2))*CT**2/B(1)
            DNY = (0.5*(FRIB(1) + FRIB(2))*ST + FRIB(3))/B(1)
            DNXY= (FRIB(1) - FRIB(2))*ST*CT/B(1)
         ELSE
            DNX = (0.5*(FRIB(1) + FRIB(2))*CT + FRIB(3))/B(1)
            DNY = (FRIB(1) + FRIB(2))*ST*ST/B(1)
            DNXY= (FRIB(1) - FRIB(2))*CT*ST/B(1)
         ENDIF
         IF (ISTIF(2).NE.4) THEN
            ARCC = H(2)
         ELSE
            ARCC = 2.*SQRT(H(2)**2 +.25*(W2(2)-W(2))**2)
         ENDIF
         NAPPL(1) = RES(1,1,1) + DNX
         NAPPL(2) = RES(2,1,1) + DNY
     1                 +(RES(1,3,2)*ARCC +RES(1,4,2)*W(2))/B(2)
         NAPPL(3) = RES(3,1,1) + DNXY
      ENDIF
C END AUG 1992
      RETURN
      END
C
C
C
C=DECK      INVRTC
      SUBROUTINE INVRTC(C11,C12,C22,C33,A11,A12,A22,A33)
C
C  PURPOSE IS TO CALCULATE A11,A12,A22,A33 BY INVERTING THE SIMPLE
C  3X3 MATRIX WITH ONLY NONZERO ELEMENTS C11,C12,C22,C33.
C
      DEL = C11*C22 - C12**2
      IF (DEL.EQ.0.) RETURN
C
      A11 = C22/DEL
      A12 = -C12/DEL
      A22 = C11/DEL
      A33 = 1./C33
C
      RETURN
      END
C
C
C
C=DECK      DIVIDE
      SUBROUTINE DIVIDE(NSEG,CX,CY,ISTIF,ZPARTX,ZPARTY,THERMX,
     1                  THERMY,ICOCUR,FSTRN,GSTRN,STIF1L,STIF2L,
     1                  EAVEP,RESPGL)
C
C  PURPOSE IS TO OBTAIN RESULTANTS IN ALL SEGMENTS DUE TO UNIFORM
C  NORMAL PRESSURE ACTING ON GLOBAL (SMEARED STIFFENER) MODEL OF
C  THE ENTIRE PANEL. THESE RESULTANTS ARE NEEDED AS INPUT TO THE
C  CALCULATIONS FOR NONLINEAR STATIC RESPONSE OF THE PANEL MODULE
C  TO UNIFORM NORMAL PRESSURE.
      COMMON/GEOM2/B(2),B2(2),H(2),W(2),W2(2)
      DIMENSION NSEG(*),CX(6,6,5),CY(6,6,5),ISTIF(*),ZPARTX(*)
      DIMENSION ZPARTY(*),FSTRN(5,2,5),GSTRN(5,2,5)
      DIMENSION ICOCUR(*),EAVEP(6),RESPGL(3,5,2),EPSPGL(3,5,2)
      DIMENSION THERMX(6,5),THERMY(6,5),EPSBP(6),EPP(6),EPSP(6)
      REAL KX3P,KY2P,KX2P,KY3P
C
      CALL MOVER(0.,0,RESPGL,1,30)
      CALL MOVER(0.,0,EPSPGL,1,30)
C
C  GET STRAIN AND CURVATURE CHANGE DISTRIBUTION FROM NORMAL PRESSURE...
C
      CALL STRDIS(1,1,0.,FSTRN(1,1,5),GSTRN(1,1,5),B,B2,EAVEP,CX,CY,
     1           THERMX,THERMY,
C BEG JULY 1989
     1           EX3P, EY2P, EX2P, EY3P, KX3P, KY2P, KX2P, KY3P, ISTIF)
C END JULY 1989
C
      CALL EPSSKN(1,1,0.,0.,EX2P, EY3P, EX3P, EY2P, 0., CX,CY,EPSPGL)
C
C
      EPP(1)= EX2P
      EPP(2)= EY3P
      EPP(3)= 0.
      EPP(4)= KX2P
      EPP(5)= KY3P
      EPP(6)= EAVEP(6)
C
      CALL RES(1,1,CX(1,1,1),THERMX(1,1),EPP,0.,0.,RESPGL)
C
C  NEXT, THE RESULTANTS
C  IN SEGMENT 2 (THICKENED REGION UNDER STIFFENER). IT IS ASSUMED
C  THAT THE AXIAL STRAIN IS UNIFORM IN THIN AND THICK PARTS AND THE
C  TRANSVERSE IN-PLANE RESULTANT IS UNIFORM IN THIN AND THICK PARTS..
C
  110 CONTINUE
C
      IF (NSEG(1).GT.1) THEN
C
         EPSP(1) = EAVEP(1)
         EPSP(2) = EY2P
         EPSP(3) = 0.
         EPSP(4) = KX2P
         EPSP(5) = KY2P
         EPSP(6) = EAVEP(6)
C
         CALL RES(2,1,CX(1,1,2),THERMX(1,2),EPSP,0.,0.,RESPGL)
      ENDIF
C
C  NEXT, GET RESULTANTS AND TOTAL FORCES IN WEB AND FLANGE OF
C  STRINGER...
C
      CALL WEBFLN(0.,EPSP(1),EPSP(4),ICOCUR(1),ZPARTX,
     1            THERMX,CX,ISTIF(1),NSEG(1),B(1),B2(1),H(1),W(1),W2(1),
     1            RESPGL(1,3,1),RESPGL(1,4,1),STIF1L,EPSPGL(1,1,1))
C
C  FOLLOW SAME LOGIC FOR Y-DIRECTION PANEL MODULE THICK PARTS...
C
  150 CONTINUE
C
      IF (NSEG(2).GT.1) THEN
C
         EPSBP(1) = EY3P
         EPSBP(2) = EX3P
         EPSBP(3) = 0.
         EPSBP(4) = KY3P
         EPSBP(5) = KX3P
         EPSBP(6) = EAVEP(6)
C
         CALL RES(2,2,CY(1,1,2),THERMY(1,2),EPSBP,0.,0., RESPGL)
C
      ENDIF
C
  160 CONTINUE
C
C  NEXT, GET RESULTANTS AND TOTAL FORCE IN WEB AND FLANGE OF RING..
C
C
      CALL WEBFLN(0.,EPSBP(1),EPSBP(4),ICOCUR(2),ZPARTY,
     1            THERMY,CY,ISTIF(2),NSEG(2),B(2),B2(2),H(2),W(2),W2(2),
     1            RESPGL(1,3,2),RESPGL(1,4,2),STIF2L,EPSPGL(1,1,2))
C
C
      RETURN
      END
C
C BEG 1 MAY 1989
C
C=DECK      BOWMOM
C BEG JULY 1995
C23456789012345678901234567890123456789012345678901234567890123456789012
      SUBROUTINE BOWMOM(INDX,C,MX,MY,IBPRE,AXIAL,CIRC,BOWMX,BOWMY,CURVY,
     1                  FEPS1,FEPS2)
C END JULY 1995
C
C  CALLED FROM FORCES.
C
C  PURPOSE IS TO CALCULATE BOWING AMPLITUDES DUE TO APPLIED
C  MOMENTS MX, MY.  C IS THE 6X6 CONSTITUTIVE LAW OF THE FORM
C
C          '  `    ---                          --- '   `
C          |0 |    |C11  C12   0   C14   C15   0  | |ex |
C          |0 |    |C12  C22   0   C24   C25   0  | |ey |
C          |0 | =  |0    0    C33   0     0   C36 | | 0 |   (1)
C          |Mx|    |C14  C24   0   C44   C45   0  | |Kx |
C          |My|    |C15  C25   0   C45   C55   0  | |Ky |
C          |0 |    |0    0    C36   0     0   C66 | | 0 |
C          `  '    ---                          --- `   '
C
C  THE METHOD IS:
C      1. First use the first two of Eqs. (1) to solve for the in-plane
C         strain components ex and ey in terms of the curvature changes
C         Kx and Ky.
C
C      2. Next, use the 4th and 5th of Eqs. (1), in combination with
C         the results of Step 1, to solve for Kx and Ky in terms of the
C         known applied moments, Mx and My.
C
C      3. Given the curvature changes, Kx and Ky, calculate the amplitudes
C         of the axial bow BOWMX and the hoop bow BOWMY, at the middle
C         of the panel, which is of axial length AXIAL and hoop length,
C         CIRC.  The curvature changes Kx and Ky are assumed to be
C         constant over the entire panel surface.
C
C     NOTE: IT IS ASSUMED THAT AXIAL AND HOOP MOMENTS GIVE RISE ONLY
C           TO IN-PLANE STRAINS ex AND ey AND TO CURVATURE CHANGES
C           Kx and Ky.  There is no in-plane shearing or twisting due
C           to these applied moments.  This is an approximation that
C           results from the form of the constitutive law assumed in (1).
C           It should be okay to do this for the purpose of preliminary
C           design.
C
      DIMENSION C(6,6)
      REAL KX,KY,MX,MY
C
C  IF PANEL IS CLAMPED, SET BOWMX, BOWMY = 0 AND MX, MY = 0 AND RETURN
C
C BEG AUG 1992
C BEG JULY 1995
      IF (INDX.EQ.0.AND.(IBPRE.EQ.1.OR.IBPRE.EQ.2)) THEN
C END JULY 1995
C END AUG 1992
         BOWMX = 0.
         BOWMY = 0.
         MX    = 0.
         MY    = 0.
         RETURN
      ENDIF
C
      B11 = C(2,2)*C(1,4) - C(1,2)*C(2,4)
      B12 = C(2,2)*C(1,5) - C(1,2)*C(2,5)
      B21 = C(1,1)*C(2,4) - C(1,2)*C(1,4)
      B22 = C(1,1)*C(2,5) - C(1,2)*C(1,5)
C
      DEN1 = C(1,1)*C(2,2) - C(1,2)**2
      C44BAR = C(4,4) -(B11*C(1,4) + B21*C(2,4))/DEN1
      C45BAR = C(4,5) -(B12*C(1,4) + B22*C(2,4))/DEN1
      C54BAR = C(4,5) -(B11*C(1,5) + B21*C(2,5))/DEN1
      C55BAR = C(5,5) -(B12*C(1,5) + B22*C(2,5))/DEN1
C
      DEN = C44BAR*C55BAR - C45BAR*C54BAR
C BEG JULY 1995
      IF (INDX.EQ.0) THEN
         KX  = (MX*C55BAR - MY*C45BAR)/DEN
         KY  = (MY*C44BAR - MX*C54BAR)/DEN
C
C AXIAL AND CIRCUMFERENTIAL BOWING...
C
         BOWMX = -KX*AXIAL**2/8.
         BOWMY = -KY*CIRC**2/8.
      ENDIF
      IF (INDX.EQ.1) THEN
C
C  FIND THE CHANGE IN HOOP CURVATURE CURVY AND THE CHANGES IN
C  NORMAL (AXIAL,HOOP) STRAINS, (FEPS1,FEPS2) FOR A CYLINDRICAL
C  PANEL WITH AN APPLIED MOMENT MY ALONG THE TWO GENERATORS.
C  THIS SECTION OF CODE IS ENTERED ONLY IF THE PANEL IS CYLINDRICAL.
C
         CURVY = MY*(C44BAR - C45BAR*C54BAR/(C55BAR*DEN))/DEN
         FEPS1 = -B12*CURVY/DEN1
         FEPS2 = -B22*CURVY/DEN1
      ENDIF
C
C  THE THREE QUANTITIES, CURVY, FEPS1, FEPS2, ARE USED TO UPDATE
C  EPSLOD(5), EPSLOD(1), EPSLOD(2), RESPECTIVELY, LATER IN SUB. FORCEX.
C END JULY 1995
C
      RETURN
      END
